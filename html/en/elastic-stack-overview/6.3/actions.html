<!DOCTYPE html>
<html lang="en-us">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Actions
        | Elastic Stack Overview [6.3]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elastic Stack Overview [6.3]" /><link rel="up" href="xpack-alerting.html" title="Alerting on Cluster and Index Events" /><link rel="prev" href="condition.html" title="Conditions" /><link rel="next" href="transform.html" title="Transforms" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Elastic Stack/Overview/6.3" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.subject" content="Elastic Stack" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.identifier" content="6.3" />
    <!-- RTP tag -->
    <script type='text/javascript' async>
    (function(c,h,a,f,i,e){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};c[a].a=i;c[a].e=e;var g=h.createElement("script");g.async=true;g.type="text/javascript";g.src=f+'?aid='+i;var b=h.getElementsByTagName("script")[0];b.parentNode.insertBefore(g,b);})(window,document,"rtp","//sjrtp2-cdn.marketo.com/rtp-api/v1/rtp.js","elasticco");

    rtp('send','view');
    rtp('get', 'campaign',true);
    </script> 
    <!-- End of RTP tag -->
    

    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
<meta name="apple-mobile-web-app-title" content="Elastic">
<meta name="application-name" content="Elastic">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">
<!-- DC tags section -->
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
<link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >



	



<!-- end DC tags -->


	<meta name="description" content="" />



	<meta name="localized" content="true" />


















		
			<meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
		

		

    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">

	   
    <!-- css -->
    <link href="/static/css/main.css" rel="stylesheet">
    
    

    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.cookie.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
      // ---------------------------- set language based on browser language --------------------
      var lang = '/'+(navigator.language || navigator.userLanguage).slice(0,2)+'/',
        locales = {
            '/en/': '/',
            '/de/': '/de/',
            '/fr/': '/fr/',
            '/ja/':'/jp/',
            '/ko/':'/kr/',
            '/zh/':'/cn/'
        }
        localepages = ['/','/de/','/fr/','/jp/','/kr/','/cn/','/products','/de/products','/fr/products','/jp/products','/kr/products','/cn/products'],
        locationpath = window.location.pathname,
        localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}',
        currentlocale = JSON.parse(localeUrl);
    
      if(localepages.indexOf(locationpath) != -1){
        if($.cookie("c_lang")){
          if($.cookie("c_lang") != currentlocale.relative_url_prefix){
            var cookieurl = $.cookie("c_lang") + currentlocale.url.slice(1,currentlocale.url.length);
            window.location = cookieurl;
          }
        }
        else{
          var locale_lang = "/";
          if(locales[lang] != undefined){
            locale_lang = locales[lang];
          }
          $.cookie("c_lang",locale_lang ,{ expires: 365, path: '/'}); 
          window.location = localepages[localepages.indexOf(locationpath)];
        }
      }
      
      // --------------------- end of set language based on browser language -----------------
      </script>


	
	<link type="text/css" rel="stylesheet" href="/static/css/guide.css" />


  
<link rel="stylesheet" type="text/css" href="styles.css" />

</head>
  <body >
  	<!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5"
                              height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- begin olark code -->
    <script data-cfasync="false" type='text/javascript'>/*<![CDATA[*/window.olark||(function(c){var f=window,d=document,l=f.location.protocol=="https:"?"https:":"http:",z=c.name,r="load";var nt=function(){
    f[z]=function(){
    (a.s=a.s||[]).push(arguments)};var a=f[z]._={
    },q=c.methods.length;while(q--){(function(n){f[z][n]=function(){
    f[z]("call",n,arguments)}})(c.methods[q])}a.l=c.loader;a.i=nt;a.p={
    0:+new Date};a.P=function(u){
    a.p[u]=new Date-a.p[0]};function s(){
    a.P(r);f[z](r)}f.addEventListener?f.addEventListener(r,s,false):f.attachEvent("on"+r,s);var ld=function(){function p(hd){
    hd="head";return["<",hd,"></",hd,"><",i,' onl' + 'oad="var d=',g,";d.getElementsByTagName('head')[0].",j,"(d.",h,"('script')).",k,"='",l,"//",a.l,"'",'"',"></",i,">"].join("")}var i="body",m=d[i];if(!m){
    return setTimeout(ld,100)}a.P(1);var j="appendChild",h="createElement",k="src",n=d[h]("div"),v=n[j](d[h](z)),b=d[h]("iframe"),g="document",e="domain",o;n.style.display="none";m.insertBefore(n,m.firstChild).id=z;b.frameBorder="0";b.id=z+"-loader";if(/MSIE[ ]+6/.test(navigator.userAgent)){
    b.src="javascript:false"}b.allowTransparency="true";v[j](b);try{
    b.contentWindow[g].open()}catch(w){
    c[e]=d[e];o="javascript:var d="+g+".open();d.domain='"+d.domain+"';";b[k]=o+"void(0);"}try{
    var t=b.contentWindow[g];t.write(p());t.close()}catch(x){
    b[k]=o+'d.write("'+p().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}a.P(2)};ld()};nt()})({
    loader: "static.olark.com/jsclient/loader0.js",name:"olark",methods:["configure","extend","declare","identify"]});
    /* custom configuration goes here (www.olark.com/documentation) */
    olark.identify('1356-750-10-5709');/*]]>*/</script><noscript><a href="https://www.olark.com/site/1356-750-10-5709/contact" title="Contact us">Questions? Feedback?</a> powered by <a href="http://www.olark.com?welcome" title="Olark live chat software">Olark live chat software</a></noscript>
    <!-- end olark code -->

<!--     <script> 
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ 
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), 
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) 
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); 
      ga('create', 'UA-12395217-16', 'auto'); 
      ga('send', 'pageview'); 
    </script> -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->
    
    <!-- Header Section -->
    
<header class="header-wrapper">
  


  




<div class="navigation-wrapper">
  <div class="container">
    <nav class="navbar">
    <!-- Brand and toggle get grouped for better mobile display -->

    <div class="navbar-mobile-header navbar-header mr-20 mr-xs-0">
      <div class="row hidden-sm hidden-md hidden-lg">
        <div class="col-xs-5 hidden-sm hidden-md hidden-lg">
          <div class="navbar-mobile-header-icon navbar-mobile-header-icon-out">
            <span></span>
            <span></span>
            <span></span>
          </div>
          
        </div>
        <div class="col-xs-2 text-center">
          <div class="navbar-brand" id="elastic">
            <h1>
              <a class="logo-m hidden-sm hidden-md hidden-lg" href="/">
                <img src="/assets/bltd5ac38b4549d53de/elastic-logo-mobile (1).svg" alt="elastic-logo-mobile">
              </a>
            </h1>
          </div>
        </div>
        <div class="col-xs-5 hidden-sm hidden-md hidden-lg text-right">
          <ul class="menu-m hidden-sm hidden-md hidden-lg">
            <li class=""><a class="icon-contact" href="/contact"></a></li>
            <li id="searchbar"><a class="button icon" href="#" alt="Search"></a></li>
            <li class="lang global-language">
                
                  
                    <a href="#">EN</a>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              <ul class="language-list">
                
                  
                    
                  
                <li><a href="/" data-value="/" id="locale-select">English</a></li>
                
                  
                    
                  
                <li><a href="/fr/" data-value="/fr/" id="locale-select">Français</a></li>
                
                  
                    
                  
                <li><a href="/de/" data-value="/de/" id="locale-select">Deutsch</a></li>
                
                  
                    
                  
                <li><a href="/jp/" data-value="/jp/" id="locale-select">日本語</a></li>
                
                  
                    
                  
                <li><a href="/kr/" data-value="/kr/" id="locale-select">한국어</a></li>
                
                  
                    
                  
                <li><a href="/cn/" data-value="/cn/" id="locale-select">简体中文</a></li>
                
              </ul>
            </li>
          </ul>
        </div>
      </div>

      <div class="navbar-brand hidden-xs" id="elastic">
        <h1>
          <a class="hidden-xs" id="elastic-logo" href="/">
            <img src="/assets/blt6050efb80ceabd47/elastic-logo (2).svg" alt="elastic-logo">
          </a>
        </h1>
      </div>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse mobile-inner-nav">
      <nav class="nav navbar-nav primary-nav-hover" id="nav">
        <ul>
        
          
            
              
            
            <li>
              <a id="nav_products" class=" " href="/products">Products</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_cloud" class=" " href="/cloud">Cloud</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_services" class=" " href="/services">Services</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_customers" class=" " href="/use-cases">Customers</a>
            </li>
          
        
          
            
              
            
            <li>
              <a id="nav_learn" class=" " href="/learn">Learn</a>
            </li>
          
        
          
        
        </ul>
      </nav>
      <nav class="nav navbar-nav navbar-right hidden-xs">
        <ul>
          <li class="hidden-xs hidden-sm"><a href="/downloads">downloads</a></li>
          <li class="hidden-xs hidden-md hidden-lg"><a class="icon-download" href="/downloads"></a></li>
          <!-- To set parameters to contact button -->
          
           
            
          

          
            
            
          
          <li class="hidden-xs hidden-sm"><a class="btn btn-secondary btn-contact" href="/contact?storm=global-header-en">contact</a></li>
          <!-- ////////////////ends here///////////////-->          
          <li class="hidden-xs hidden-md hidden-lg"><a class="icon-contact" href="/contact?storm=global-header-en"></a></li>
          <li class="hidden-xs" id="searchbar"><a class="button icon" href="#" alt="Search"></a></li>
          <li class="hidden-xs lang global-language">
                
                  
                    <a href="#">EN</a>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
               <ul class="language-list">
              
                
                  
                
              <li><a class="" href="/" data-value="/">English</a></li>
              
                
                  
                
              <li><a class="" href="/fr/" data-value="/fr/">Français</a></li>
              
                
                  
                
              <li><a class="" href="/de/" data-value="/de/">Deutsch</a></li>
              
                
                  
                
              <li><a class="" href="/jp/" data-value="/jp/">日本語</a></li>
              
                
                  
                
              <li><a class="" href="/kr/" data-value="/kr/">한국어</a></li>
              
                
                  
                
              <li><a class="" href="/cn/" data-value="/cn/">简体中文</a></li>
              
            </ul>
          </li>
        </ul>
      </nav>
    </div><!-- /.navbar-collapse -->
  </nav>
  </div>
</div>

<div class="header-search-wrapper open-search"> 
  <div class="container">
    <div class="big-search">
      <i class="big-search-icon"></i>
      <form id="searchfrm" name="searchForm" autocomplete="on" action="/search" method="get">
        <ul class="tags-wrapper">
          <li class="search-field"><input type="text" name="q" id="autocomplete" class="form-control global-input" autocomplete="off"></li>
        </ul>
      </form>
      <a class="header-search-cancel" href="#"></a>
    </div>
    <div class="nav-auto-complete"></div>
  </div>
</div>
</header>
<link rel="stylesheet" type="text/css" href="/static/css/horizon-swiper.min.css">
<style> 
    
      .m-shortcuts li a.m-search {
        background: url("/assets/blt7b9c4fe6528dc4ef/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-docs {
        background: url("/assets/blt44d8b7530a76d01c/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
      .m-shortcuts li a.m-contact {
        background: url("/assets/blt878040795c9d083b/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    
    
</style>
<script type="text/javascript" src="/static/js/horizon-swiper.min.js"></script>
<script type="text/javascript">
  $(document).ready( function(){
    // if($('#scrollable-pane li').length > 3){
      $('.horizon-swiper').horizonSwiper({
        showItems: 3,
        arrows: true
      }); 
    // }
    
    $('.navbar-toggle').on('click', function(){
      $('.mobile-navigation, .menu-open').hide();
      $('.navigation-wrapper').addClass('mobile-navigation');
      $('.navbar').addClass('menu-open');
      $('.menu-close').show();
    });
    $('.menu-close').on('click', function(){
      $('.navigation-wrapper').removeClass('mobile-navigation');
      $('.navbar').removeClass('menu-open');
      $('.menu-close').hide();
    });

    var active_url = "";

    $(".navbar-mobile-header-icon").click(function(index){
      $('.navigation-wrapper').toggleClass('menu-overlay');
      $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
      $(".mobile-inner-nav").slideToggle(500);
      $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
        $(this).css({'animation-delay': (index/25)+'0.4s'});
      });
    });

    $('.dropdown-btn').on('click', function(e){
      e.preventDefault();
      setDropdown();
    });
    
    function setDropdown() {
      $('#myDropdown').slideToggle();
    }

    $('body').on('click', function(event){
      if (!event.target.matches('.dropdown-btn')) {

        var dropdowns = $(".dropdown-content");
        var i;
        for (i = 0; i < dropdowns.length; i++) {
          var openDropdown = dropdowns[i];
          if (openDropdown.classList.contains('show')) {
            openDropdown.classList.remove('show');
          }
        }
      }
    });

    // if($(window).width() < 769){
    //   var $item = $('.scrollable-panel li'), 
    //       visible = 3, //Set the number of items that will be visible
    //       index = 0, //Starting index
    //       endIndex = ( $item.length / visible ) - 1; //End index (NOTE:: Requires visible to be a factor of $item.length... You can improve this by rounding...)

    //   $('#right-arrow').click(function(){
    //     if(index < endIndex ){
    //       index++;
    //       $item.animate({'left':'-=300px'});
    //     }
    //   });

    //   $('#left-arrow').click(function(){
    //     if(index > 0){
    //       index--;            
    //       $item.animate({'left':'+=300px'});
    //     }
    //   });
    // }
  });
  $(window).resize(function () {
    $('.horizon-swiper').horizonSwiper({
      showItems: 3,
      arrows: true
    });
  });
</script>
    
      


  





  
  
  
  
    <div class="tertiary-nav bdr-btm-e0e0e0">
      <div class="container">
        <div class="p-t-b-15 clearfix">
          <div class="breadcrum-wrapper pull-left text-left">
          
            <a href="/guide">Docs</a> 
          
          </div>
          
          
          
        </div>
      </div>
    </div>

    <div class="nav-mobile-dropdown hidden-sm hidden-md hidden-lg bdr-btm-e0e0e0 clearfix">
      <div class="container text-right">
        <div class="breadcrum-wrapper pull-left text-left">
          
              <a href="/guide">Docs</a>
          
        </div>
        
        
      </div>
    </div>
  


<style type="text/css">

  
</style>
    
    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">   
          
            
        			<!-- <div class="pageheader">
	<div class="common-container">
		
			<h2 class="page-title">Guide template</h2>
		
	</div>
</div> -->


        		
          

          
	<section id="guide" lang="en">
		<div class="container">
			<div class="row">
			  <!-- start body -->
				
            <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
            <!-- start body -->
<div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elastic Stack Overview
      [6.3]
    </a></span> » <span class="breadcrumb-link"><a href="xpack-alerting.html">Alerting on Cluster and Index Events</a></span> » <span class="breadcrumb-node">Actions</span></div><div class="navheader"><span class="prev"><a href="condition.html">
              « 
              Conditions</a>
           
        </span><span class="next">
           
          <a href="transform.html">Transforms
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="actions"></a>Actions<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>When a watch’s condition is met, its actions are executed unless it is being
<a class="link" href="actions.html#actions-ack-throttle" title="Acknowledgement and Throttlingedit">throttled</a>. A watch can perform multiple actions.
The actions are executed one at a time and each action executes independently.
Any failures encountered while executing an action are recorded in the
action result and in the watch history.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>If no actions are defined for a watch, no actions are executed.
        However, a <code class="literal">watch_record</code> is still written to the watch history.</p></div></div><p>Actions have access to the payload in the execution context. They can use it to
support their execution in any way they need. For example, the payload might
serve as a model for a templated email body.</p><p>Watcher supports the following types of actions:
<a class="link" href="actions.html#actions-email" title="Email Action">email</a>, <a class="link" href="actions.html#actions-webhook" title="Webhook Action">webhook</a>, <a class="link" href="actions.html#actions-index" title="Index Action">index</a>,
<a class="link" href="actions.html#actions-logging" title="Logging Action">logging</a>, <a class="link" href="actions.html#actions-hipchat" title="HipChat Action">hipchat</a>, <a class="link" href="actions.html#actions-slack" title="Slack Action">Slack</a>, and <a class="link" href="actions.html#actions-pagerduty" title="PagerDuty Action">pagerduty</a>.</p><h3><a id="actions-ack-throttle"></a>Acknowledgement and Throttling<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>During the watch execution, once the condition is met, a decision is made per
configured action as to whether it should be throttled. The main purpose of
action throttling is to prevent too many executions of the same action for the
same watch.</p><p>For example, suppose you have a watch that detects errors in an application’s log
entries. The watch is triggered every five minutes and searches for errors during
the last hour. In this case, if there are errors, there is a period of time where
the watch is checked and its actions are executed multiple times based on the same
errors. As a result, the system administrator receives multiple notifications about
the same issue, which can be annoying.</p><p>To address this issue, Watcher supports time-based throttling. You can define
a throttling period as part of the action configuration to limit how often the
action is executed. When you set a throttling period, Watcher prevents repeated
execution of the action if it has already executed within the throttling period
time frame (<code class="literal">now - throttling period</code>).</p><p>The following snippet shows a watch for the scenario described above - associating
a throttle period with the <code class="literal">email_administrator</code> action:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">PUT _xpack/watcher/watch/error_logs_alert
{
  "metadata" : {
    "color" : "red"
  },
  "trigger" : {
    "schedule" : {
      "interval" : "5m"
    }
  },
  "input" : {
    "search" : {
      "request" : {
        "indices" : "log-events",
        "body" : {
          "size" : 0,
          "query" : { "match" : { "status" : "error" } }
        }
      }
    }
  },
  "condition" : {
    "compare" : { "ctx.payload.hits.total" : { "gt" : 5 }}
  },
  "actions" : {
    "email_administrator" : {
      "throttle_period": "15m", <a id="CO28-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      "email" : { <a id="CO28-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
        "to" : "sys.admino@host.domain",
        "subject" : "Encountered {{ctx.payload.hits.total}} errors",
        "body" : "Too many error in the system, see attached data",
        "attachments" : {
          "attached_data" : {
            "data" : {
              "format" : "json"
            }
          }
        },
        "priority" : "high"
      }
    }
  }
}</pre></div><div class="console_widget" data-snippet="snippets/actions/1.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO28-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
There will be at least 15 minutes between subsequent <code class="literal">email_administrator</code>
                action executions.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO28-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
See <a class="link" href="actions.html#actions-email" title="Email Action">Email Action</a> for more information.
</p></td></tr></table></div><p>You can also define a throttle period at the watch level. The watch-level
throttle period serves as the default throttle period for all of the actions
defined in the watch:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">PUT _xpack/watcher/watch/log_event_watch
{
  "trigger" : {
    "schedule" : { "interval" : "5m" }
  },
  "input" : {
    "search" : {
      "request" : {
        "indices" : "log-events",
        "body" : {
          "size" : 0,
          "query" : { "match" : { "status" : "error" } }
        }
      }
    }
  },
  "condition" : {
    "compare" : { "ctx.payload.hits.total" : { "gt" : 5 }}
  },
  "throttle_period" : "15m", <a id="CO29-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
  "actions" : {
    "email_administrator" : {
      "email" : {
        "to" : "sys.admino@host.domain",
        "subject" : "Encountered {{ctx.payload.hits.total}} errors",
        "body" : "Too many error in the system, see attached data",
        "attachments" : {
          "attached_data" : {
            "data" : {
              "format" : "json"
            }
          }
        },
        "priority" : "high"
      }
    },
    "notify_pager" : {
      "webhook" : {
        "method" : "POST",
        "host" : "pager.service.domain",
        "port" : 1234,
        "path" : "/{{watch_id}}",
        "body" : "Encountered {{ctx.payload.hits.total}} errors"
      }
    }
  }
}</pre></div><div class="console_widget" data-snippet="snippets/actions/2.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO29-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
There will be at least 15 minutes between subsequent action executions
                (applies to both <code class="literal">email_administrator</code> and <code class="literal">notify_pager</code> actions)
</p></td></tr></table></div><p>If you do not define a throttle period at the action or watch level, the global
default throttle period is applied. Initially, this is set to 5 seconds. To
change the global default, configure the <code class="literal">xpack.watcher.execution.default_throttle_period</code>
setting in <code class="literal">elasticsearch.yml</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.watcher.execution.default_throttle_period: 15m</pre></div><p>Watcher also supports acknowledgement-based throttling. You can acknowledge a
watch using the <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/watcher-api-ack-watch.html" target="_top">Ack Watch API</a> to prevent the
watch actions from being executed again while the watch condition remains <code class="literal">true</code>.
This essentially tells Watcher "I received the notification and I’m handling
it, please do not notify me about this error again". An acknowledged watch action
remains in the <code class="literal">acked</code> state until the watch’s condition evaluates to <code class="literal">false</code>.
When that happens, the action’s state changes to <code class="literal">awaits_successful_execution</code>.</p><p>To acknowledge an action, you use the
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/watcher-api-ack-watch.html" target="_top">Ack Watch API</a>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">POST _xpack/watcher/watch/&lt;id&gt;/_ack/&lt;action_ids&gt;</pre></div><div class="console_widget" data-snippet="snippets/actions/3.json"></div><p>Where <code class="literal">&lt;id&gt;</code> is the id of the watch and <code class="literal">&lt;action_ids&gt;</code> is a comma-separated list
of the action ids you want to acknowledge. To acknowledge all actions, omit the
<code class="literal">actions</code> parameter.</p><p>The following diagram illustrates the throttling decisions made for each action
of a watch during its execution:</p><div class="informalfigure"><div class="mediaobject" align="center"><img src="images/action-throttling.jpg" align="middle" alt="images/action-throttling.jpg" /></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="action-conditions"></a>Adding conditions to actions<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>When a watch is triggered, its condition determines whether or not to execute the
watch actions. Within each action, you can also add a condition per action. These
additional conditions enable a single alert to execute different actions depending
on a their respective conditions. The following watch would alway send an email, when
hits are found from the input search, but only trigger the <code class="literal">notify_pager</code> action when
there are more than 5 hits in the search result.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">PUT _xpack/watcher/watch/log_event_watch
{
  "trigger" : {
    "schedule" : { "interval" : "5m" }
  },
  "input" : {
    "search" : {
      "request" : {
        "indices" : "log-events",
        "body" : {
          "size" : 0,
          "query" : { "match" : { "status" : "error" } }
        }
      }
    }
  },
  "condition" : {
    "compare" : { "ctx.payload.hits.total" : { "gt" : 0 } }
  },
  "actions" : {
    "email_administrator" : {
      "email" : {
        "to" : "sys.admino@host.domain",
        "subject" : "Encountered {{ctx.payload.hits.total}} errors",
        "body" : "Too many error in the system, see attached data",
        "attachments" : {
          "attached_data" : {
            "data" : {
              "format" : "json"
            }
          }
        },
        "priority" : "high"
      }
    },
    "notify_pager" : {
      "condition": { <a id="CO30-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
        "compare" : { "ctx.payload.hits.total" : { "gt" : 5 } }
      },
      "webhook" : {
        "method" : "POST",
        "host" : "pager.service.domain",
        "port" : 1234,
        "path" : "/{{watch_id}}",
        "body" : "Encountered {{ctx.payload.hits.total}} errors"
      }
    }
  }
}</pre></div><div class="console_widget" data-snippet="snippets/actions/4.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO30-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
A <code class="literal">condition</code> that only applies to the <code class="literal">notify_pager</code> action, which
    restricts its execution to when the condition succeeds (at least 5 hits in this case).
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="actions-email"></a>Email Action<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/email.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Use the <code class="literal">email</code> action to send email notifications. To send email, you must
<a class="link" href="actions.html#configuring-email" title="Configuring Email Accounts">configure at least one email account</a> in
<code class="literal">elasticsearch.yml</code>.</p><p>Email notifications can be plain text or styled using HTML. You can include
information from the watch execution payload using <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>
and attach the entire watch payload to the message.</p><p>See <a class="xref" href="actions.html#email-action-attributes" title="Email Action Attributes">Email Action Attributes</a> for the supported attributes. Any attributes that
are missing from the email action definition are looked up in the email
account configuration. The required attributes must either be set in the email
action definition or the account’s <code class="literal">email_defaults</code>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuring-email-actions"></a>Configuring Email Actions<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/email.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You configure email actions in the <code class="literal">actions</code> array. Action-specific attributes
are specified using the <code class="literal">email</code> keyword.</p><p>For example, the following email action uses a template to include data from
the watch payload in the email body:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "send_email" : { <a id="CO31-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    "email" : { <a id="CO31-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
      "to" : "&lt;username&gt;@&lt;domainname&gt;", <a id="CO31-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
      "subject" : "Watcher Notification", <a id="CO31-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
      "body" : "{{ctx.payload.hits.total}} error logs found" <a id="CO31-5"></a><span><img src="images/icons/callouts/5.png" alt="" /></span>
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO31-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The id of the action.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO31-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The action type is set to <code class="literal">email</code>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO31-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
One or more addresses to send the email to. Must be specified in the
    action definition or in the email account configuration.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO31-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The subject of the email can contain static text and Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO31-5"><span><img src="images/icons/callouts/5.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The body of the email can contain static text and Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>. Must be specified in the action definition or in the email
     account configuration.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuring-email-attachments"></a>Configuring Email Attachments<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/email.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You can attach the execution context payload or data from an any HTTP service to
the email notification. There is no limit on the number of attachments you can
configure.</p><p>To configure attachments, specify a name for the attached file and the type of
attachment: <code class="literal">data</code>, <code class="literal">http</code> or <code class="literal">reporting</code>. The <code class="literal">data</code> attachment type attaches the execution
context payload to the email message. The <code class="literal">http</code> attachment type enables
you to issue an HTTP request and attach the response to the email message. When
configuring the <code class="literal">http</code> attachment type, you must specify the request URL. The
<code class="literal">reporting</code> attachment type is a special type to include PDF rendered dashboards
from kibana. This type is consistently polling the kibana app if the dashboard
rendering is done, preventing long running HTTP connections, that are potentially
killed by firewalls or load balancers inbetween.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "email_admin" : {
    "email": {
      "to": "John Doe &lt;john.doe@example.com&gt;",
      "attachments" : {
        "my_image.png" : { <a id="CO32-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
          "http" : { <a id="CO32-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
            "content_type" : "image.png",
            "request" : {
              "url": "http://example.org/foo/my-image.png" <a id="CO32-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
            }
          }
        },
        "dashboard.pdf" : {
          "reporting" : {
            "url": "http://example.org:5601/api/reporting/generate/dashboard/Error-Monitoring"
          }
        },
        "data.yml" : {
          "data" : {
            "format" : "yaml" <a id="CO32-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
          }
        }
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO32-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The ID of the attachment, which is used as the file name in the email
    attachment.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO32-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The type of the attachment and its specific configuration.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO32-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The URL from which to retrieve the attachment.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO32-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Data attachments default to JSON if you don’t specify the format.
</p></td></tr></table></div><div class="table"><a id="id-1.11.9.29.6.6"></a><p class="title"><strong>Table 30. <code class="literal">http</code> attachment type attributes</strong></p><div class="table-contents"><table summary="http attachment type attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top"> Name            </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">content_type</code></p></td><td align="left" valign="top"><p>Sets the content type for the email attachment. By default,
                    the content type is extracted from the response sent by the
                    HTTP service. You can explicitly specify the content type to
                    ensure that the type is set correctly in the email in case
                    the response does not specify the content type or it’s specified
                    incorrectly. Optional.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">inline</code></p></td><td align="left" valign="top"><p>Configures as an attachment to sent with disposition <code class="literal">inline</code>. This
                    allows the use of embedded images in HTML bodies, which are displayed
                    in certain email clients. Optional. Defaults to <code class="literal">false</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request</code></p></td><td align="left" valign="top"><p>Contains the HTTP request attributes. At a minimum, you must
                    specify the <code class="literal">url</code> attribute to configure the host and path to
                    the service endpoint. See <a class="xref" href="actions.html#webhook-action-attributes">???</a> for
                    the full list of HTTP request attributes. Required.</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="id-1.11.9.29.6.7"></a><p class="title"><strong>Table 31. <code class="literal">data</code> attachment type attributes</strong></p><div class="table-contents"><table summary="data attachment type attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top"> Name        </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">format</code></p></td><td align="left" valign="top"><p>Attaches the watch data, equivalent to specifying <code class="literal">attach_data</code>
                in the watch configuration. Possible values are <code class="literal">json</code> or <code class="literal">yaml</code>.
                Defaults to <code class="literal">json</code> if not specified.</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="table"><a id="id-1.11.9.29.6.8"></a><p class="title"><strong>Table 32. <code class="literal">reporting</code> attachment type attributes</strong></p><div class="table-contents"><table summary="reporting attachment type attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top"> Name            </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">url</code></p></td><td align="left" valign="top"><p>The URL to trigger the dashboard creation</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">inline</code></p></td><td align="left" valign="top"><p>Configures as an attachment to sent with disposition <code class="literal">inline</code>. This
                    allows the use of embedded images in HTML bodies, which are displayed
                    in certain email clients. Optional. Defaults to <code class="literal">false</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">retries</code></p></td><td align="left" valign="top"><p>The reporting attachment type tries to poll regularly to receive the
                    created PDF. This configures the number of retries. Defaults to <code class="literal">40</code>.
                    The setting <code class="literal">xpack.notification.reporting.retries</code> can be configured
                    globally to change the default.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">interval</code></p></td><td align="left" valign="top"><p>The time to wait between two polling tries. Defaults to <code class="literal">15s</code> (this
                    means, by default watcher tries to download a dashboard for 10 minutes,
                    forty times fifteen seconds). The setting <code class="literal">xpack.notification.reporting.interval</code>
                    can be configured globally to change the default.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request.auth</code></p></td><td align="left" valign="top"><p>Additional auth configuration for the request</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">request.proxy</code></p></td><td align="left" valign="top"><p>Additional proxy configuration for the request</p></td></tr></tbody></table></div></div><br class="table-break" /><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="email-action-reports"></a>Attaching Reports to an Email<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/email.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>You can use the <code class="literal">reporting</code> attachment type in an <code class="literal">email</code> action to automatically
generate a Kibana report and distribute it via email.</p><p>For example, the following watch generates a report that contains the
<span class="strong strong"><strong>Error Monitoring</strong></span> dashboard and emails the report every hour:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">PUT _xpack/watcher/watch/error_report
{
  "trigger" : {
    "schedule": {
      "interval": "1h"
    }
  },
  "actions" : {
    "email_admin" : { <a id="CO33-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      "email": {
        "to": "'Recipient Name &lt;recipient@example.com&gt;'",
        "subject": "Error Monitoring Report",
        "attachments" : {
          "error_report.pdf" : {
            "reporting" : {
              "url": "http://0.0.0.0:5601/api/reporting/generate/dashboard/Error-Monitoring?_g=(time:(from:now-1d%2Fd,mode:quick,to:now))", <a id="CO33-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
              "retries":6, <a id="CO33-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
              "interval":"1s", <a id="CO33-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
              "auth":{ <a id="CO33-5"></a><span><img src="images/icons/callouts/5.png" alt="" /></span>
                "basic":{
                  "username":"elastic",
                  "password":"changeme"
                }
              }
            }
          }
        }
      }
    }
  }
}</pre></div><div class="console_widget" data-snippet="snippets/actions/5.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO33-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
You must configure at least one email account to enable Watcher to send email.
For more information, see
<a class="ulink" href="https://www.elastic.co/guide/en/elastic-stack-overview/6.3/actions-email.html#configuring-email" target="_top">Configuring Email Accounts</a>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO33-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
This is an example Generation URL. You can copy and paste the URL for any
report from the Kibana UI.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO33-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Optional, default is 40
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO33-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Optional, default is 15s
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO33-5"><span><img src="images/icons/callouts/5.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Provide user credentials for a user with permission to access Kibana and
X-Pack reporting.


</p></td></tr></table></div><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>The interval between report requests must be longer than the time it
takes to generate the reports—otherwise, the report queue can back up. To
avoid this, increase the time between report requests.</p><p>By default, report generation times out if the report cannot be generated
within 30 seconds. If you are generating reports that contain complex
visualizations or your machine is slow or under constant heavy load, it
might take longer than 30 seconds to generate a report. You can increase
the timeout by setting <code class="literal">xpack.reporting.queue.timeout</code> in <code class="literal">kibana.yml</code>.</p></div></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="email-action-attributes"></a>Email Action Attributes<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/email.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th align="left" valign="top"> Name                  </th><th align="center" valign="top">Required   </th><th align="left" valign="top"> Default             </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">account</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>the default account</p></td><td align="left" valign="top"><p>The <a class="link" href="actions.html#configuring-email" title="Configuring Email Accounts">email account</a> to use to send the email.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">from</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The email <a class="link" href="actions.html#email-address">address</a> from which the email
                                                            will be sent. The <code class="literal">from</code> field can contain Mustache
                                                            <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a> as long as it resolves to a
                                                            valid email address.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">to</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The email <a class="link" href="actions.html#email-address">addresses</a> of the <code class="literal">to</code> recipients.
                                                            The <code class="literal">to</code> field can contain Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>
                                                            as long as it resolves to a valid email address.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">cc</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The email <a class="link" href="actions.html#email-address">addresses</a> of the <code class="literal">cc</code> recipients.
                                                            The <code class="literal">cc</code> field can contain Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>
                                                            as long as it resolves to a valid email address.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">bcc</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The email <a class="link" href="actions.html#email-address">addresses</a> of the <code class="literal">bcc</code> recipients.
                                                            The <code class="literal">bcc</code> field can contain Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>
                                                            as long as it resolves to a valid email address.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">reply_to</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The email <a class="link" href="actions.html#email-address">addresses</a> that will be set on the
                                                            message’s <code class="literal">Reply-To</code> header. The <code class="literal">reply_to</code> field can contain
                                                            Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a> as long as it resolves to
                                                            a valid email address.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">subject</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The subject of the email. The subject can be static text or
                                                            contain Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">body</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The body of the email. When this field holds a string, it
                                                            will default to the text body of the email. Set as an object
                                                            to specify either the text or the html body or both (using
                                                            the fields below)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">body.text</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The plain text body of the email. The body can be static text
                                                            or contain Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>. The email <code class="literal">body</code>
                                                            must contain at least one <code class="literal">text</code> or <code class="literal">html</code> field.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">body.html</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The html body of the email. The body can be static text or
                                                            contain Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>. This body will be
                                                            sanitized to remove dangerous content such as scripts. This
                                                            behavior can be disabled by setting
                                                            <code class="literal">xpack.notification.email.html.sanitization.enabled: false</code> in
                                                            <code class="literal">elasticsearch.yaml</code>. The email <code class="literal">body</code> must contain at least
                                                            one <code class="literal">text</code> or <code class="literal">html</code> field.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">priority</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The priority of this email. Valid values are: <code class="literal">lowest</code>, <code class="literal">low</code>,
                                                            <code class="literal">normal</code>, <code class="literal">high</code> and <code class="literal">highest</code>. The priority can contain a
                                                            Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">template</a> as long as it resolves to
                                                            one of the valid values.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">attachments</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>Attaches the watch payload (<code class="literal">data</code> attachment) or a file
                                                            retrieved from an HTTP service (<code class="literal">http</code> attachment) to the
                                                            email. For more information, see
                                                            <a class="link" href="actions.html#configuring-email-attachments" title="Configuring Email Attachments">Configuring Email Attachments</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">attach_data</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>false</p></td><td align="left" valign="top"><p>Indicates whether the watch execution data should be attached
                                                            to the email. You can specify a Boolean value or an object.
                                                            If <code class="literal">attach_data</code> is set to  <code class="literal">true</code>, the data is attached as a
                                                            YAML file. This attribute is deprecated, use the <code class="literal">attachments</code>
                                                            attribute to add a <code class="literal">data</code> attachment to attach the watch payload.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">attach_data.format</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>yaml</p></td><td align="left" valign="top"><p>When <code class="literal">attach_data</code> is specified as an object, this field
                                                            controls the format of the attached data. The supported formats
                                                            are <code class="literal">json</code> and <code class="literal">yaml</code>. This attribute is deprecated, use the
                                                            <code class="literal">attachments</code> attribute to add a <code class="literal">data</code> attachment to attach
                                                            the watch payload.</p></td></tr></tbody></table></div><div class="variablelist"><a id="email-address"></a><dl class="variablelist"><dt><span class="term">
Email Address
</span></dt><dd>
An email address can contain two possible parts—the address itself and an
optional personal name as described in <a class="ulink" href="http://www.ietf.org/rfc/rfc822.txt" target="_top">RFC 822</a>.
The address can be represented either as a string of the form <code class="literal">user@host.domain</code>
or <code class="literal">Personal Name &lt;user@host.domain&gt;</code>. You can also specify an email address as
an object that contains <code class="literal">name</code> and <code class="literal">address</code> fields.
</dd><dt><span class="term">
Address List
</span></dt><dd>
A list of addresses can be specified as a an
array: <code class="literal">[ 'Personal Name &lt;user1@host.domain&gt;', 'user2@host.domain' ]</code>.
</dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuring-email"></a>Configuring Email Accounts<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/email.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Watcher can send email using any SMTP email service. Email
messages can contain basic HTML tags. You can control which groups of tags are
allowed by <a class="link" href="actions.html#email-html-sanitization" title="Configuring HTML Sanitization Optionsedit">Configuring HTML Sanitization Options</a>.</p><p>You configure the accounts Watcher can use to send email in the
<code class="literal">xpack.notification.email</code> namespace in <code class="literal">elasticsearch.yml</code>.</p><p>If your email account is configured to require two step verification, you need
to generate and use a unique App Password to send email from Watcher.
Authentication will fail if you use your primary password.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>Currently, neither Watcher nor Shield provide a mechanism to encrypt
settings in <code class="literal">elasticsearch.yml</code>. Because the email account credentials appear
in plain text, you should limit access to <code class="literal">elasticsearch.yml</code> to the user that
you use to run Elasticsearch.</p></div></div><p><a id="email-profile"></a>Watcher provides three email profiles that control how MIME messages are
structured: <code class="literal">standard</code> (default), <code class="literal">gmail</code>, and <code class="literal">outlook</code>. These profiles
accommodate differences in how various email systems interpret the MIME
standard. If you are using Gmail or Outlook, we recommend using the
corresponding profile. Use the <code class="literal">standard</code> profile if you are using another
email system.</p><p>For more information about configuring Watcher to work with different email
systems, see:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<a class="link" href="actions.html#gmail" title="Sending Email From Gmailedit">Sending Email from Gmail</a>
</li><li class="listitem">
<a class="link" href="actions.html#outlook" title="Sending Email from Outlook.comedit">Sending Email from Outlook</a>
</li><li class="listitem">
<a class="link" href="actions.html#exchange" title="Sending Email from Microsoft Exchangeedit">Sending Email from Exchange</a>
</li><li class="listitem">
<a class="link" href="actions.html#amazon-ses" title="Sending Email from Amazon SES (Simple Email Service)edit">Sending Email from Amazon SES</a>
</li></ul></div><p>If you configure multiple email accounts, you must either configure a default
account or specify which account the email should be sent with in the
<a class="link" href="actions.html#actions-email" title="Email Action"><code class="literal">email</code></a> action.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.email:
  default_account: team1
  account:
    team1:
      ...
    team2:
      ...</pre></div><h5><a id="gmail"></a>Sending Email From Gmail<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/email.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>Use the following email account settings to send email from the
<a class="ulink" href="https://mail.google.com" target="_top">Gmail</a> SMTP service:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.email.account:
    gmail_account:
        profile: gmail
        smtp:
            auth: true
            starttls.enable: true
            host: smtp.gmail.com
            port: 587
            user: &lt;username&gt;
            password: &lt;password&gt;</pre></div><p>If you get an authentication error that indicates that you need to continue the
sign-in process from a web browser when Watcher attempts to send email, you need
to configure Gmail to <a class="ulink" href="https://support.google.com/accounts/answer/6010255?hl=en" target="_top">Allow
Less Secure Apps to access your account</a>.</p><p>If two-step verification is enabled for your account, you must generate and use
a unique App Password to send email from Watcher. See
<a class="ulink" href="https://support.google.com/accounts/answer/185833?hl=en" target="_top">Sign in using App Passwords</a>
for more information.</p><h5><a id="outlook"></a>Sending Email from Outlook.com<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/email.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>Use the following email account settings to send email action from the
<a class="ulink" href="https://www.outlook.com/" target="_top">Outlook.com</a> SMTP service:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.email.account:
    outlook_account:
        profile: outlook
        smtp:
            auth: true
            starttls.enable: true
            host: smtp-mail.outlook.com
            port: 587
            user: &lt;email.address&gt;
            password: &lt;password&gt;</pre></div><p>When sending emails, you have to provide a from address, either a default one
in your account configuration or as part of the email action in the watch.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>You need to use a unique App Password if two-step verification is enabled.
        See <a class="ulink" href="http://windows.microsoft.com/en-us/windows/app-passwords-two-step-verification" target="_top">App
        passwords and two-step verification</a> for more information.</p></div></div><h5><a id="amazon-ses"></a>Sending Email from Amazon SES (Simple Email Service)<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/email.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>Use the following email account settings to send email from the
<a class="ulink" href="http://aws.amazon.com/ses" target="_top">Amazon Simple Email Service</a> (SES) SMTP service:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.email.account:
    ses_account:
        smtp:
            auth: true
            starttls.enable: true
            starttls.required: true
            host: email-smtp.us-east-1.amazonaws.com <a id="CO34-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
            port: 587
            user: &lt;username&gt;
            password: &lt;password&gt;</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO34-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
<code class="literal">smtp.host</code> varies depending on the region
</p></td></tr></table></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>You need to use your Amazon SES SMTP credentials to send email through
        Amazon SES. For more information, see
        <a class="ulink" href="http://docs.aws.amazon.com/ses/latest/DeveloperGuide/smtp-credentials.html" target="_top">Obtaining
        Your Amazon SES SMTP Credentials</a>. You might also need to verify
        <a class="ulink" href="https://docs.aws.amazon.com/ses/latest/DeveloperGuide/verify-email-addresses.html" target="_top">your email address</a>
        or <a class="ulink" href="https://docs.aws.amazon.com/ses/latest/DeveloperGuide/verify-domains.html" target="_top">your whole domain</a>
        at AWS.</p></div></div><h5><a id="exchange"></a>Sending Email from Microsoft Exchange<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/email.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>Use the following email account settings to send email action from Microsoft
Exchange:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.email.account:
    exchange_account:
        profile: outlook
        email_defaults:
            from: &lt;email address of service account&gt; <a id="CO35-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
        smtp:
            auth: true
            starttls.enable: true
            host: &lt;your exchange server&gt;
            port: 587
            user: &lt;email address of service account&gt; <a id="CO35-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
            password: &lt;password&gt;</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO35-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Some organizations configure Exchange to validate that the <code class="literal">from</code> field is a
    valid local email account.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO35-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Many organizations support use of your email address as your username, though
    it is a good idea to check with your system administrator if you receive
    authentication-related failures.
</p></td></tr></table></div><h5><a id="email-html-sanitization"></a>Configuring HTML Sanitization Options<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/email.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h5><p>The <code class="literal">email</code> action supports sending messages with an HTML body. However, for
security reasons, Watcher <a class="ulink" href="https://en.wikipedia.org/wiki/HTML_sanitization" target="_top">sanitizes</a>
the HTML.</p><p>You can control which HTML features are allowed or disallowed by configuring the
<code class="literal">xpack.notification.email.html.sanitization.allow</code> and
<code class="literal">xpack.notification.email.html.sanitization.disallow</code> settings in
<code class="literal">elasticsearch.yml</code>. You can specify individual HTML elements and
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/notification-settings.html#html-feature-groups" target="_top">HTML feature groups</a>. By default, Watcher allows the following
features: <code class="literal">body</code>, <code class="literal">head</code>, <code class="literal">_tables</code>, <code class="literal">_links</code>, <code class="literal">_blocks</code>, <code class="literal">_formatting</code> and
<code class="literal">img:embedded</code>.</p><p>For example, the following settings allow the HTML to contain tables and block
elements, but disallow  <code class="literal">&lt;h4&gt;</code>, <code class="literal">&lt;h5&gt;</code> and <code class="literal">&lt;h6&gt;</code> tags.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.email.html.sanitization:
    allow: _tables, _blocks
    disallow: h4, h5, h6</pre></div><p>To disable sanitization entirely, add the following setting to
<code class="literal">elasticsearch.yml</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.email.html.sanitization.enabled: false</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="actions-webhook"></a>Webhook Action<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/webhook.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Use the <code class="literal">webhook</code> action to send a request to any web service. The
webhook action supports both HTTP and HTTPS connections. See
<a class="link" href="actions.html#webhook-action-attributes">Webhook Action Attributes</a> for the supported
attributes.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuring-webook-actions"></a>Configuring Webhook Actions<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/webhook.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You configure webhook actions in the <code class="literal">actions</code> array. Action-specific attributes
are specified using the <code class="literal">webhook</code> keyword.</p><p>The following snippet shows a simple webhook action definition:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "my_webhook" : { <a id="CO36-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    "transform" : { ... }, <a id="CO36-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
    "throttle_period" : "5m", <a id="CO36-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
    "webhook" : {
      "method" : "POST", <a id="CO36-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
      "host" : "mylisteningserver", <a id="CO36-5"></a><span><img src="images/icons/callouts/5.png" alt="" /></span>
      "port" : 9200, <a id="CO36-6"></a><span><img src="images/icons/callouts/6.png" alt="" /></span>
      "path": ":/{{ctx.watch_id}", <a id="CO36-7"></a><span><img src="images/icons/callouts/7.png" alt="" /></span>
      "body" : "{{ctx.watch_id}}:{{ctx.payload.hits.total}}" <a id="CO36-8"></a><span><img src="images/icons/callouts/8.png" alt="" /></span>
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO36-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The id of the action
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO36-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
An optional <a class="link" href="transform.html" title="Transforms">transform</a> to transform the payload before
    executing the <code class="literal">webhook</code> action
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO36-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
An optional <a class="link" href="actions.html#actions-ack-throttle" title="Acknowledgement and Throttlingedit">throttle period</a> for the action
    (5 minutes in this example)
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO36-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The HTTP method to use when connecting to the host
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO36-5"><span><img src="images/icons/callouts/5.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The host to connect to
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO36-6"><span><img src="images/icons/callouts/6.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The port to connect to
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO36-7"><span><img src="images/icons/callouts/7.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The path (URI) to use in the HTTP request
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO36-8"><span><img src="images/icons/callouts/8.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The body to send with the request
</p></td></tr></table></div><p>You can use basic authentication when sending a request to a secured webservice.
For example, the following <code class="literal">webhook</code> action creates a new issue in GitHub:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "create_github_issue" : {
    "transform": {
      "script": "return ['title':'Found errors in \\'contact.html\\'', 'body' : 'Found ' + ctx.payload.hits.total + ' errors in the last 5 minutes', 'assignee' : 'web-admin', 'labels' : ['bug','sev2']]"
    },
    "webhook" : {
      "method" : "POST",
      "url" : "https://api.github.com/repos/&lt;owner&gt;/&lt;repo&gt;/issues",
      "body": "{{#toJson}}ctx.payload{{/toJson}}",
      "auth" : {
        "basic" : {
          "username" : "&lt;username&gt;", <a id="CO37-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
          "password" : "&lt;password&gt;"
        }
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO37-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The username and password for the user creating the issue
</p></td></tr></table></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>By default, both the username and the password are stored in the <code class="literal">.watches</code>
      index in plain text. When X-Pack security is enabled, Watcher can encrypt the
      password before storing it.</p></div></div><p>You can also use PKI-based authentication when submitting requests to a cluster
secured with X-Pack security. When you use PKI-based authentication instead of HTTP
basic auth, you don’t need to store any authentication information in the watch
itself. To use PKI-based authentication, you <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/notification-settings.html#ssl-notification-settings" target="_top">https://www.elastic.co/guide/en/elasticsearch/reference/6.3/notification-settings.html#ssl-notification-settings</a>
[configure the SSL key settings] for Watcher in <code class="literal">elasticsearch.yml</code>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="webhook-query-parameters"></a>Query Parameters<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/webhook.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You can specify query parameters to send with the request with the <code class="literal">params</code> field.
This field simply holds an object where the keys serve as the parameter names and
the values serve as the parameter values:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "my_webhook" : {
    "webhook" : {
      "method" : "POST",
      "host" : "mylisteningserver",
      "port" : 9200,
      "path": ":/alert",
      "params" : {
        "watch_id" : "{{ctx.watch_id}}" <a id="CO38-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO38-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The parameter values can contain templated strings.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="webhook-custom-request-headers"></a>Custom Request Headers<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/webhook.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You can specify request headers to send with the request with the <code class="literal">headers</code> field.
This field simply holds an object where the keys serve as the header names and
the values serve as the header values:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "my_webhook" : {
    "webhook" : {
      "method" : "POST",
      "host" : "mylisteningserver",
      "port" : 9200,
      "path": ":/alert/{{ctx.watch_id}}",
      "headers" : {
        "Content-Type" : "application/yaml" <a id="CO39-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      },
      "body" : "count: {{ctx.payload.hits.total}}"
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO39-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The header values can contain templated strings.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_webhook_action_attributes"></a>Webhook Action Attributes<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/webhook.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="informaltable"><a id="webhook-action-attributes"></a><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th align="left" valign="top"> Name                  </th><th align="center" valign="top">Required   </th><th align="center" valign="top"> Default     </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">scheme</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>http</p></td><td align="left" valign="top"><p>The connection scheme. Valid values are: <code class="literal">http</code> or <code class="literal">https</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">host</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The host to connect to.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">port</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The port the HTTP service is listening on.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">path</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The URL path. The path can be static text or include Mustache
                                                    <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>. URL query string parameters must be
                                                    specified via the <code class="literal">request.params</code> attribute.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">method</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>get</p></td><td align="left" valign="top"><p>The HTTP method. Valid values are: <code class="literal">head</code>, <code class="literal">get</code>, <code class="literal">post</code>, <code class="literal">put</code>
                                                    and <code class="literal">delete</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">headers</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The HTTP request headers. The header values can be static text
                                                    or include Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">params</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The URL query string parameters. The parameter values can be
                                                    static text or include Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">auth</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>Authentication related HTTP headers. Currently, only basic
                                                    authentication is supported.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">body</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The HTTP request body. The body can be static text or include
                                                    Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>. When not specified, an empty
                                                    body is sent.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">proxy.host</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The proxy host to use when connecting to the host.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">proxy.port</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>The proxy port to use when connecting to the host.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">connection_timeout</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>10s</p></td><td align="left" valign="top"><p>The timeout for setting up the http connection. If the connection
                                                    could not be set up within this time, the action will timeout and
                                                    fail.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">read_timeout</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>10s</p></td><td align="left" valign="top"><p>The timeout for reading data from http connection. If no response
                                                    was received within this time, the action will timeout and fail.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">url</code></p></td><td align="center" valign="top"><p>no</p></td><td align="center" valign="top"><p>-</p></td><td align="left" valign="top"><p>A shortcut for specifying the request scheme, host, port, and
                                                    path as a single string. For example, <code class="literal">http://example.org/foo/my-service</code>.</p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="actions-index"></a>Index Action<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/index.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Use the <code class="literal">index</code> action to index data into Elasticsearch.
See <a class="xref" href="actions.html#index-action-attributes" title="Index Action Attributes">Index Action Attributes</a> for the supported attributes.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_configuring_index_actions"></a>Configuring Index Actions<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/index.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The following snippet shows a simple <code class="literal">index</code> action definition:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "index_payload" : { <a id="CO40-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    "condition": { ... }, <a id="CO40-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
    "transform": { ... }, <a id="CO40-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
    "index" : {
      "index" : "my-index", <a id="CO40-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
      "doc_type" : "my-type", <a id="CO40-5"></a><span><img src="images/icons/callouts/5.png" alt="" /></span>
      "doc_id": "my-id" <a id="CO40-6"></a><span><img src="images/icons/callouts/6.png" alt="" /></span>
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO40-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The id of the action
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO40-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
An optional <a class="link" href="condition.html" title="Conditions">condition</a> to restrict action execution
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO40-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
An optional <a class="link" href="transform.html" title="Transforms">transform</a> to transform the payload and prepare the data that should be indexed
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO40-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The elasticsearch index to store the data to
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO40-5"><span><img src="images/icons/callouts/5.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The document type to store the data as
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO40-6"><span><img src="images/icons/callouts/6.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
An optional <code class="literal">_id</code> for the document, if it should always be the same document.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="index-action-attributes"></a>Index Action Attributes<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/index.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th align="left" valign="top">Name                     </th><th align="left" valign="top">Required    </th><th align="left" valign="top"> Default    </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">index</code></p></td><td align="left" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The Elasticsearch index to index into.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">doc_type</code></p></td><td align="left" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The type of the document the data will be indexed as.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">doc_id</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The optional <code class="literal">_id</code> of the document.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">execution_time_field</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The field that will store/index the watch execution
                                                      time.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">timeout</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>60s</p></td><td align="left" valign="top"><p>The timeout for waiting for the index api call to
                                                      return. If no response is returned within this time,
                                                      the index action times out and fails. This setting
                                                      overrides  the default  timeouts.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">refresh</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>Optional setting of the <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/docs-refresh.html" target="_top">refresh policy</a>
                                                      for the write request</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="anatomy-actions-index-multi-doc-support"></a>Multi-Document Support<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/index.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Like with all other actions, you can use a <a class="link" href="transform.html" title="Transforms">transform</a> to replace
the current execution context payload with another and by that change the document
that will end up indexed.</p><p>The index action plays well with transforms with its support for the special <code class="literal">_doc</code>
payload field.</p><p>When resolving the document to be indexed, the index action first looks up for a
<code class="literal">_doc</code> field in the payload. When not found, the payload is indexed as a single
document.</p><p>When a <code class="literal">_doc</code> field exists, if the field holds an object, it is extracted and indexed
as a single document. If the field holds an array of objects, each object is treated as
a document and the index action indexes all of them in a bulk.</p><p>An <code class="literal">_index</code>, <code class="literal">_type</code> or <code class="literal">_id</code> value can be added per document to dynamically set the ID
of the indexed document.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="actions-logging"></a>Logging Action<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/logging.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Use the <code class="literal">logging</code> action to log text to the standard Elasticsearch
logs. See <a class="xref" href="actions.html#logging-action-attributes" title="Logging Action Attributes">Logging Action Attributes</a> for the supported attributes.</p><p>This action is primarily used during development and for debugging purposes.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuring-logging-actions"></a>Configuring Logging Actions<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/logging.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You configure logging actions in the <code class="literal">actions</code> array. Action-specific attributes
are specified using the <code class="literal">logging</code> keyword.</p><p>The following snippet shows a simple logging action definition:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "log" : { <a id="CO41-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    "transform" : { ... }, <a id="CO41-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
    "logging" : {
      "text" : "executed at {{ctx.execution_time}}" <a id="CO41-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO41-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The id of the action.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO41-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
An optional <a class="link" href="transform.html" title="Transforms">transform</a> to transform the payload before
    executing the <code class="literal">logging</code> action.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO41-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The text to be logged.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="logging-action-attributes"></a>Logging Action Attributes<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/logging.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th align="left" valign="top"> Name        </th><th align="left" valign="top">Required </th><th align="left" valign="top"> Default                       </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">text</code></p></td><td align="left" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The text that should be logged. Can be static text or
                                                          include Mustache <a class="link" href="how-watcher-works.html#templates" title="Using Templatesedit">templates</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">category</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>xpack.watcher.actions.logging</p></td><td align="left" valign="top"><p>The category under which the text will be logged.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">level</code></p></td><td align="left" valign="top"><p>no</p></td><td align="left" valign="top"><p>info</p></td><td align="left" valign="top"><p>The logging level. Valid values are: <code class="literal">error</code>, <code class="literal">warn</code>,
                                                          <code class="literal">info</code>, <code class="literal">debug</code> and <code class="literal">trace</code>.</p></td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="actions-hipchat"></a>HipChat Action<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/hipchat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Use the <code class="literal">hipchat</code> action to send messages to <a class="ulink" href="https://www.hipchat.com" target="_top">HipChat</a>
rooms or users. To send HipChat messages, you must
<a class="link" href="actions.html#configuring-hipchat" title="Configuring HipChat Accounts">configure at least one HipChat account</a> in <code class="literal">elasticsearch.yml</code>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuring-hipchat-actions"></a>Configuring HipChat Actions<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/hipchat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You configure HipChat actions in a <code class="literal">actions</code> array. Action-specific attributes
are specified using the <code class="literal">hipchat</code> keyword. You must specify the <code class="literal">message</code>
attribute for all <code class="literal">hipchat</code> actions. If you omit the <code class="literal">account</code> attribute, the
message is sent using the default HipChat account configured in
<code class="literal">elasticsearch.yml</code>.</p><p>For example, the following action is configured to send messages using a HipChat
account that uses the <a class="link" href="actions.html#hipchat-api-integration" title="Using the Hipchat Integration Profile">integration</a> profile. Because
this type of account can only send messages to a specific room, the only required
attribute is the message itself:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-hipchat" : {
    "transform" : { ... },
    "throttle_period" : "5m",
    "hipchat" : {
      "account" : "integration-account", <a id="CO42-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      "message" : {
        "body" : "Encountered  {{ctx.payload.hits.total}} errors in the last 5 minutes (facepalm)", <a id="CO42-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
        "format" : "text",
        "color" : "red",
        "notify" : true
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO42-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The name of a HipChat account configured in <code class="literal">elasticsearch.yml</code>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO42-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The message you want to send to HipChat.
</p></td></tr></table></div><p>To send messages with a HipChat account that uses the <a class="link" href="actions.html#hipchat-api-user" title="Using the HipChat User Profile">user</a>
profile, you need to specify what rooms and users you want to send the message to.
For example, the following action is configured to send messages to the
<code class="literal">mission-control</code> and <code class="literal">devops</code> rooms as well as the user <code class="literal">website-admin@example.com</code>.
(To send to multiple users or rooms, specify an array of strings):</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-hipchat" : {
    "transform" : { ... },
    "throttle_period" : "5m",
    "hipchat" : {
      "account" : "user-account",
      "message" : {
        "room" : [ "mission-control", "devops" ],
        "user" : "website-admin@example.com",
        "body" : "Encountered  {{ctx.payload.hits.total}} errors in the last 5 minutes (facepalm)",
        "format" : "text",
        "color" : "red",
        "notify" : true
      }
    }
  }
}</pre></div><p>To send messages with a HipChat account that uses the <a class="link" href="actions.html#hipchat-api-v1" title="Using the HipChat v1 Profile">v1</a>
profile, you need to specify what room or rooms you want to send the message to.
For example, the following action is configured to send messages to the
<code class="literal">server-status</code> room. (To send to multiple rooms, specify an array of strings.)</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-hipchat" : {
    "transform" : { ... },
    "throttle_period" : "5m",
    "hipchat" : {
      "account" : "v1-account",
      "message" : {
        "from" : "Watcher",
        "room" : [ "server-status", "infra-team" ],
        "body" : "Encountered  {{ctx.payload.hits.total}} errors in the last 5 minutes (facepalm)",
        "format" : "text",
        "color" : "red",
        "notify" : true
      }
    }
  }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="hipchat-action-attributes"></a>HipChat Action Attributes<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/hipchat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /></colgroup><thead><tr><th align="left" valign="top"> Name              </th><th align="center" valign="top">Required </th><th align="left" valign="top"> Default         </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">account</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Default account</p></td><td align="left" valign="top"><p>The HipChat account to use to send the message.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">proxy.host</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The proxy host to use (only in combination with <code class="literal">proxy.port</code>)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">proxy.port</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The proxy port to use (only in combination with <code class="literal">proxy.host</code>)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.body</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The message content. Can contain up to 1000 characters.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.format</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>html</p></td><td align="left" valign="top"><p>The format of the message: <code class="literal">text</code> or <code class="literal">html</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.color</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>yellow</p></td><td align="left" valign="top"><p>The background color of the notification in the room:
                                                  <code class="literal">gray</code>, <code class="literal">green</code>, <code class="literal">purple</code>, <code class="literal">red</code>, <code class="literal">yellow</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.notify</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>false</p></td><td align="left" valign="top"><p>Indicates whether people in the room should be actively
                                                  notified</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.from</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>the watch ID</p></td><td align="left" valign="top"><p>The name that appears as the notification sender. Only
                                                  valid for accounts that use the v1 profile.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.room</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The rooms that the notification should go to. Accepts
                                                  a string value or an array of string values. Must be
                                                  specified when using the v1 profile. At least one room
                                                  or user must be specified when using the <code class="literal">user</code> profile.
                                                  Not valid for the <code class="literal">integration</code> profile.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.user</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td><td align="left" valign="top"><p>The users that the notification should go to. Accepts
                                                  a string value or an array of string values. At least
                                                  one room or user must be specified when using the <code class="literal">user</code>
                                                  profile. Not valid for the <code class="literal">integration</code> or <code class="literal">v1</code> profiles.</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuring-hipchat"></a>Configuring HipChat Accounts<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/hipchat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You configure the accounts Watcher can use to communicate with HipChat in the
<code class="literal">xpack.notification.hipchat</code> namespace in <code class="literal">elasticsearch.yml</code>. Both
<a class="ulink" href="https://www.hipchat.com/docs/api" target="_top">v1</a> and
<a class="ulink" href="https://www.hipchat.com/docs/apiv2" target="_top">v2</a> HipChat APIs are supported.</p><p>Watcher provides three HipChat API profiles:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<a class="link" href="actions.html#hipchat-api-integration" title="Using the Hipchat Integration Profile">integration</a>
</span></dt><dd>
Sends messages to a specific room using HipChat’s v2 API
<a class="ulink" href="https://www.hipchat.com/docs/apiv2/method/send_room_notification" target="_top">Send room
notification</a>.
</dd><dt><span class="term">
<a class="link" href="actions.html#hipchat-api-user" title="Using the HipChat User Profile">user</a>
</span></dt><dd>
Sends messages as a particular user through the HipChat v2 API. Enables you to
send messages to arbitrary rooms or users.
</dd><dt><span class="term">
<a class="link" href="actions.html#hipchat-api-v1" title="Using the HipChat v1 Profile">v1</a>
</span></dt><dd><p class="simpara">
Sends messages to rooms using HipChat’s v1 API
<a class="ulink" href="https://www.hipchat.com/docs/api/method/rooms/message" target="_top">rooms/message</a>.
</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The <code class="literal">v1</code> profile is provided because it is simple to set up and this API
      is familiar to many users. That said, HipChat has deprecated the v1 API
      and is encouraging users to migrate to v2. Both the <code class="literal">integration</code> and
      <code class="literal">user</code> profiles are based on the HipChat v2 API.</p></div></div></dd></dl></div><p>If you configure multiple HipChat accounts, you either need to set a default
HipChat account or specify which account the notification should be sent with
in the <a class="link" href="actions.html#actions-hipchat" title="HipChat Action">hipchat</a> action.</p><p>Storing the <code class="literal">auth_token</code> in the configuration file or using via updating the
settings now is still supported, but you should use the keystore for this, see
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/secure-settings.html" target="_top">secure settings</a></p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.hipchat:
  default_account: team1
  account:
    team1:
      ...
    team2:
      ...</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="hipchat-api-integration"></a>Using the Hipchat Integration Profile<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/hipchat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>You can use the <code class="literal">integration</code> profile to send messages to specific rooms. When
you set an account’s profile to <code class="literal">integration</code>, the messages are sent through
HipChat’s v2 <a class="ulink" href="https://www.hipchat.com/docs/apiv2/method/send_room_notification" target="_top">
Send room notification</a> API.</p><p>When you use the <code class="literal">integration</code> profile, you need to configure a separate HipChat
account for each room you want to send messages—the account configuration
contains a room-specific authentication token. Alternatively, you can use the
<a class="link" href="actions.html#hipchat-api-user" title="Using the HipChat User Profile"><code class="literal">user</code></a> or <a class="link" href="actions.html#hipchat-api-v1" title="Using the HipChat v1 Profile"><code class="literal">v1</code></a> profile to send messages
to multiple rooms.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The <code class="literal">integration</code> profile only supports sending messages to rooms, it does
      not support sending private messages. Use the <a class="link" href="actions.html#hipchat-api-user" title="Using the HipChat User Profile"><code class="literal">user</code></a>
      profile to notify a particular HipChat user.</p></div></div><p>You need a room-specific authentication token to configure an <code class="literal">integration</code>
account. To generate an authentication token:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Log in to <a class="ulink" href="http://hipchat.com" target="_top">hipchat.com</a> or your HipChat server as a group
  administrator.
</li><li class="listitem">
Go to <span class="strong strong"><strong>Group admin &gt; Rooms</strong></span>.
</li><li class="listitem">
Click the name of the room you want to send messages to.
</li><li class="listitem">
Click the <span class="strong strong"><strong>Tokens</strong></span> link.
</li><li class="listitem"><p class="simpara">
Enter a name for the token in the <span class="strong strong"><strong>Label</strong></span> field.
</p><div class="informalfigure"><div class="mediaobject"><img src="images/hipchat-generate-room-token.jpg" alt="images/hipchat-generate-room-token.jpg" /></div></div></li><li class="listitem">
Select the <span class="strong strong"><strong>Send Notification</strong></span> scope.
</li><li class="listitem">
Click <span class="strong strong"><strong>Create</strong></span>.
</li><li class="listitem"><p class="simpara">
Copy the generated token so you can paste it into your HipChat account
  configuration in <code class="literal">elasticsearch.yml</code>.
</p><div class="informalfigure"><div class="mediaobject"><img src="images/hipchat-copy-room-token.jpg" alt="images/hipchat-copy-room-token.jpg" /></div></div></li></ol></div><p>To configure a HipChat account that uses the <code class="literal">integration</code> profile:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Set the <code class="literal">type</code> to <code class="literal">integration</code>.
</li><li class="listitem">
Set <code class="literal">room</code> to the name of the room you want to send messages to.
</li><li class="listitem">
Set <code class="literal">auth_token</code> to the room-specific authentication token.
</li></ol></div><p>For example, the following snippet configures an account called
<code class="literal">notify-monitoring</code> that sends messages to the <code class="literal">monitoring</code> room:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-shell">bin/elasticsearch-keystore add xpack.notification.hipchat.account.notify-monitoring.secure_auth_token</pre></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.hipchat:
  account:
    notify-monitoring:
      profile: integration
      room: monitoring</pre></div><p>You can also specify defaults for the <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/notification-settings.html#hipchat-account-attributes" target="_top">
message attributes</a>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.hipchat:
  account:
    notify-monitoring:
      profile: integration
      room: monitoring
      message:
        format: text
        color: blue
        notify: true</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="hipchat-api-user"></a>Using the HipChat User Profile<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/hipchat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>You can use the <code class="literal">user</code> profile to send messages to rooms as well as individual
HipChat users. When you set an account’s profile to <code class="literal">user</code>, Watcher sends
messages as a particular user through the HipChat v2 API.</p><p>Before you can configure a <code class="literal">user</code> account, you need to:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Add a HipChat user for Watcher. When setting the user name, keep in mind that
  the messages are sent on behalf of this user.
</li><li class="listitem"><p class="simpara">
Create an API token for the Watcher user:
</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
Log in to HipChat as the Watcher user.
</li><li class="listitem">
Go to <code class="literal">https://&lt;hipchat-server&gt;/account/api</code>. For example,
   <code class="literal">https://www.hipchat.com/account/api</code>.
</li><li class="listitem">
Confirm the user password.
</li><li class="listitem"><p class="simpara">
Enter a name for the token in the <span class="strong strong"><strong>Label</strong></span> field.
</p><div class="informalfigure"><div class="mediaobject"><img src="images/hipchat-generate-user-token.jpg" alt="images/hipchat-generate-user-token.jpg" /></div></div></li></ol></div></li><li class="listitem">
Select the <span class="strong strong"><strong>Send Notification</strong></span> and <span class="strong strong"><strong>Send Message</strong></span> scopes.
</li><li class="listitem">
Click <span class="strong strong"><strong>Create</strong></span>.
</li><li class="listitem"><p class="simpara">
Copy the generated token so you can paste it into your HipChat account
  configuration in <code class="literal">elasticsearch.yml</code>.
</p><div class="informalfigure"><div class="mediaobject"><img src="images/hipchat-copy-room-token.jpg" alt="images/hipchat-copy-room-token.jpg" /></div></div></li></ol></div><p>To configure a HipChat account that uses the <code class="literal">user</code> profile:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Set the <code class="literal">type</code> to <code class="literal">user</code>.
</li><li class="listitem">
Set <code class="literal">user</code> to the email address associated with the Watcher user.
</li><li class="listitem">
Set <code class="literal">auth_token</code> to the Watcher user’s authentication token.
</li></ol></div><p>For example, the following configuration creates an account called
<code class="literal">notify-monitoring</code> that sends messages to the <code class="literal">monitoring</code> room:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-shell">bin/elasticsearch-keystore add xpack.notification.hipchat.account.notify-monitoring.secure_auth_token</pre></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.hipchat:
  account:
    notify-monitoring:
      profile: user</pre></div><p>You can also specify defaults for the &lt;<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/notification-settings.html#hipchat-account-attributes" target="_top">
message attributes</a>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-shell">bin/elasticsearch-keystore add xpack.notification.hipchat.account.notify-monitoring.secure_auth_token</pre></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.hipchat:
  account:
    notify-monitoring:
      profile: user
      message:
        format: text
        color: blue
        notify: true</pre></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="hipchat-api-v1"></a>Using the HipChat v1 Profile<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/hipchat.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>You can use the <code class="literal">v1</code> profile to send messages to particular rooms. When you set
an account’s profile to <code class="literal">v1</code>, messages are sent through HipChat’s v1
<a class="ulink" href="https://www.hipchat.com/docs/api/method/rooms/message" target="_top">rooms/message</a> API.</p><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>The <code class="literal">v1</code> profile uses a deprecated API that is expected to be removed
          by HipChat in the future.</p></div></div><p>The <code class="literal">v1</code> profile only supports sending messages to rooms, it does not support
sending private messages. Use the <a class="link" href="actions.html#hipchat-api-user" title="Using the HipChat User Profile"><code class="literal">user</code></a> profile to send
private messages to HipChat users.</p><p>Before you can configure a <code class="literal">v1</code> account, you need to generate a <code class="literal">v1</code> API token:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Log in to your HipChat server as a group admin.
</li><li class="listitem">
Go to <code class="literal">https://&lt;hipchat-server&gt;/admin/api</code>. For example,
  <code class="literal">https://hipchat.com/admin/api</code>.
</li><li class="listitem">
Confirm your admin password.
</li><li class="listitem"><p class="simpara">
Select the <span class="strong strong"><strong>Notification</strong></span> type.
</p><div class="informalfigure"><div class="mediaobject"><img src="images/hipchat-generate-v1-token.jpg" alt="images/hipchat-generate-v1-token.jpg" /></div></div></li><li class="listitem">
Enter a name for the token in the <span class="strong strong"><strong>Label</strong></span> field.
</li><li class="listitem">
Click <span class="strong strong"><strong>Create</strong></span>.
</li><li class="listitem"><p class="simpara">
Copy the generated token so you can paste it into your HipChat account
  configuration in <code class="literal">elasticsearch.yml</code>.
</p><div class="informalfigure"><div class="mediaobject"><img src="images/hipchat-copy-v1-token.jpg" alt="images/hipchat-copy-v1-token.jpg" /></div></div></li></ol></div><p>To configure a HipChat account that uses the <code class="literal">v1</code> profile:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Set the <code class="literal">type</code> to <code class="literal">v1</code>.
</li><li class="listitem">
Set <code class="literal">auth_token</code> to the v1 authentication token you generated.
</li></ol></div><p>For example, the following configuration creates an account called
<code class="literal">notify-monitoring</code>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-shell">bin/elasticsearch-keystore add xpack.notification.hipchat.account.notify-monitoring.secure_auth_token</pre></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.hipchat:
  account:
    notify-monitoring:
      profile: v1</pre></div><p>You can also specify defaults for the <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/notification-settings.html#hipchat-account-attributes" target="_top">
message attributes</a>.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.hipchat:
  account:
    notify-monitoring:
      profile: v1
      message:
        format: text
        color: blue
        notify: true</pre></div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="actions-slack"></a>Slack Action<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/slack.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Use the <code class="literal">slack</code> action to send messages to a <a class="ulink" href="https://slack.com/" target="_top">Slack</a>
team’s channels or users. To send Slack messages, you need to
<a class="link" href="actions.html#configuring-slack" title="Configuring Slack Accounts">configure at least one Slack account</a> in
<code class="literal">elasticsearch.yml</code>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuring-slack-actions"></a>Configuring Slack Actions<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/slack.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You configure Slack actions in the <code class="literal">actions</code> array. Action-specific attributes
are specified using the <code class="literal">slack</code> keyword.</p><p>The following snippet shows a simple slack action definition:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-slack" : {
    "transform" : { ... },
    "throttle_period" : "5m",
    "slack" : {
      "message" : {
        "to" : [ "#admins", "@chief-admin" ], <a id="CO43-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
        "text" : "Encountered  {{ctx.payload.hits.total}} errors in the last 5 minutes (facepalm)" <a id="CO43-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO43-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The channels and users you want to send the message to.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO43-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The content of the message.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="formatting-slack-messages"></a>Using Attachments to Format Slack Messages<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/slack.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>In addition to sending simple text-based messages, you can use the Slack
<a class="ulink" href="https://api.slack.com/docs/attachments" target="_top">attachment</a> mechanism to send formatted
messages. Watcher leverages Slack attachments to enable you to dynamically
populate templated messages from the execution context payload.</p><p>The following snippet shows a standard message attachment:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-slack" : {
    "throttle_period" : "5m",
    "slack" : {
      "account" : "team1",
      "message" : {
        "from" : "watcher",
        "to" : [ "#admins", "@chief-admin" ],
        "text" : "System X Monitoring",
        "attachments" : [
          {
            "title" : "Errors Found",
            "text" : "Encountered  {{ctx.payload.hits.total}} errors in the last 5 minutes (facepalm)",
            "color" : "danger"
          }
        ]
      }
    }
  }
}</pre></div><p><a id="slack-dynamic-attachment"></a>To define an attachment template that is dynamically populated from the payload,
you specify <code class="literal">dynamic_attachments</code> in the watch action. For example, a dynamic
attachment could reference histogram buckets in the payload and build an
attachment per bucket.</p><p>In the following example, the watch input executes a search with a date histogram
aggregation and the Slack action:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Transforms the payload to a list where each item in the list holds the month,
  the user count for that month, and the color that represents the sentiment
  associated with that count (danger or bad).
</li><li class="listitem">
Defines an attachment template that references items in the list generated by
  the transform.
</li></ol></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"input" : {
  "search" : {
    "request" : {
      "body" : {
        "aggs" : {
          "users_per_month" : {
            "date_histogram" : {
              "field" : "@timestamp",
              "interval" : "month"
            }
          }
        }
      }
    }
  }
},
...
"actions" : {
  "notify-slack" : {
    "throttle_period" : "5m",
    "transform" : {
      "script" : {
        "source" : "['items': ctx.payload.aggregations.users_per_month.buckets.collect(bucket -&gt; ['count': bucket.doc_count, 'name': bucket.key_as_string, 'color': bucket.doc_count &lt; 100 ? 'danger' : 'good'])]",
        "lang" : "painless"
      }
    },
    "slack" : {
      "account" : "team1",
      "message" : {
        "from" : "watcher",
        "to" : [ "#admins", "@chief-admin" ],
        "text" : "System X Monitoring",
        "dynamic_attachments" : {
          "list_path" : "ctx.payload.items" <a id="CO44-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
          "attachment_template" : {
            "title" : "{{month}}", <a id="CO44-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
            "text" : "Users Count: {{count}}",
            "color" : "{{color}}"
          }
        }
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO44-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The list generated by the action’s transform.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO44-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The parameter placeholders refer to attributes in each item of the list
    generated by the transform.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="slack-action-attributes"></a>Slack Action Attributes<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/slack.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Name                          </th><th align="center" valign="top">Required </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">message.from</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The sender name to display in the  Slack message.
                                    Overrides the incoming webhook’s configured name.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.to</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>The channels and users you want to send the message
                                    to. Channel names must start with <code class="literal">#</code> and user names
                                    must start with <code class="literal">@</code>. Accepts a string value or an
                                    array of string values.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.icon</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The icon to display in the Slack messages. Overrides
                                    the incoming webhook’s configured icon. Accepts a
                                    public URL to an image.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.text</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>The message content.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.attachments</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Slack message attachments. Message attachments enable
                                    you to create more richly-formatted messages. Specified
                                    array as defined in the
                                    <a class="ulink" href="https://api.slack.com/docs/attachments" target="_top">Slack attachments documentation</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">message.dynamic_attachments</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Slack message attachments that can be populated
                                    dynamically based on the current watch payload. For
                                    more information, see
                                    <a class="link" href="actions.html#slack-dynamic-attachment">Using Attachments to Format Slack Messages</a>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">proxy.host</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>-</p></td></tr><tr><td align="left" valign="top"><p>The proxy host to use (only in combination with <code class="literal">proxy.port</code>)</p></td><td align="center" valign="top"><p><code class="literal">proxy.port</code></p></td><td align="left" valign="top"><p>no</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuring-slack"></a>Configuring Slack Accounts<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/slack.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You configure the accounts Watcher can use to communicate with Slack in the
<code class="literal">xpack.notification.slack</code> namespace in <code class="literal">elasticsearch.yml</code>.</p><p>You need a <a class="ulink" href="https://api.slack.com/incoming-webhooks" target="_top">Slack webhook URL</a> to
configure a Slack account. To create a webhook
URL, set up an an <span class="emphasis"><em>Incoming Webhook Integration</em></span> through the Slack console:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Log in to <a class="ulink" href="http://slack.com" target="_top">slack.com</a> as a team administrator.
</li><li class="listitem">
Go to <a class="ulink" href="https://my.slack.com/services/new/incoming-webhook" target="_top">https://my.slack.com/services/new/incoming-webhook</a>.
</li><li class="listitem"><p class="simpara">
Select a default channel for the integration.
</p><div class="informalfigure"><div class="mediaobject"><img src="images/slack-add-webhook-integration.jpg" alt="images/slack-add-webhook-integration.jpg" /></div></div></li><li class="listitem">
Click <span class="strong strong"><strong>Add Incoming Webhook Integration</strong></span>.
</li><li class="listitem"><p class="simpara">
Copy the generated webhook URL so you can paste it into your Slack account
  configuration in <code class="literal">elasticsearch.yml</code>.
</p><div class="informalfigure"><div class="mediaobject"><img src="images/slack-copy-webhook-url.jpg" alt="images/slack-copy-webhook-url.jpg" /></div></div></li></ol></div><p>To configure a Slack account, at a minimum you need to specify the account
name and webhook URL in the elasticsearch keystore (see <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/secure-settings.html" target="_top">secure settings</a>):</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-shell">bin/elasticsearch-keystore add xpack.notification.slack.account.monitoring.secure_url</pre></div><p>You can also configure this via settings in the <code class="literal">elasticsearch.yml</code> file by
removing the <code class="literal">secure_</code> prefix, but using the keystore is the preferred and
secure way of doing this.</p><p>You can also specify defaults for the <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/notification-settings.html#slack-account-attributes" target="_top">Slack
notification attributes</a>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.slack:
  account:
    monitoring:
      message_defaults:
        from: x-pack
        to: notifications
        icon: http://example.com/images/watcher-icon.jpg
        attachment:
          fallback: "X-Pack Notification"
          color: "#36a64f"
          title: "X-Pack Notification"
          title_link: "https://www.elastic.co/guide/en/x-pack/current/index.html"
          text: "One of your watches generated this notification."
          mrkdwn_in: "pretext, text"</pre></div><p>If you configure multiple Slack accounts, you either need to configure a default
account or specify which account the notification should be sent with in the
<a class="link" href="actions.html#actions-slack" title="Slack Action">slack</a> action.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.slack:
  default_account: team1
  account:
    team1:
      ...
    team2:
      ...</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="actions-pagerduty"></a>PagerDuty Action<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/pagerduty.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Use the PagerDuty action to create events in <a class="ulink" href="https://pagerduty.com/" target="_top">
PagerDuty</a>. To create PagerDuty events, you must <a class="link" href="actions.html#configuring-pagerduty" title="Configuring PagerDuty Accounts">configure at least one PagerDuty account</a> in <code class="literal">elasticsearch.yml</code>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuring-pagerduty-actions"></a>Configuring PagerDuty Actions<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/pagerduty.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You configure PagerDuty actions in the <code class="literal">actions</code> array. Action-specific attributes
are specified using the <code class="literal">pagerduty</code> keyword.</p><p>The following snippet shows a simple PagerDuty action definition:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-pagerduty" : {
    "transform" : { ... },
    "throttle_period" : "5m",
    "pagerduty" : {
      "description" : "Main system down, please check!" <a id="CO45-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO45-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Description of the message
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="adding-context-and-payloads-to-pagerduty-actions"></a>Adding Meta Information to a PagerDuty Incident<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/pagerduty.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>To give the PagerDuty incident some more context, you can attach the
payload as well as an array of contexts to the action.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "notify-pagerduty" : {
    "throttle_period" : "5m",
    "pagerduty" : {
      "account" : "team1",
      "description" : "Main system down, please check! Happened at {{ctx.execution_time}}"
      "attach_payload" : true,
      "client" : "/foo/bar/{{ctx.watch_id}}",
      "client_url" : "http://www.example.org/",
      "contexts" : [
        {
          "type": "link",
          "href": "http://acme.pagerduty.com"
        },{
          "type": "link",
          "href": "http://acme.pagerduty.com",
          "text": "View the incident on {{ctx.payload.link}}"
        }
      ]
    }
  }
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="pagerduty-action-attributes"></a>Pagerduty Action Attributes<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/pagerduty.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Name        </th><th align="center" valign="top">Required   </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">account</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The account to use, falls back to the default one.
                            The account needs a <code class="literal">service_key_api</code> attribute.</p></td></tr></tbody></table></div><div class="table"><a id="pagerduty-event-trigger-incident-attributes"></a><p class="title"><strong>Table 33. Pagerduty Event Trigger Incident Attributes</strong></p><div class="table-contents"><table summary="Pagerduty Event Trigger Incident Attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Name              </th><th align="center" valign="top">Required </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">description</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>A quick description for this event</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">event_type</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The event type to sent. Must be one of <code class="literal">trigger</code>,
                                <code class="literal">resolve</code> or <code class="literal">acknowledge</code>. Defaults to <code class="literal">trigger</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">incident_key</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The incident key on the pagerduty side, also used
                                for de-duplication and allows to resolve or acknowledge
                                incidents.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">client</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Name of the client triggering the incident, i.e.
                                <code class="literal">Watcher Monitoring</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">client_url</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>A client URL to visit to get more detailed information.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">attach_payload</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>If set to <code class="literal">true</code> the payload is attached as a detail
                                to the API call. Defaults to <code class="literal">false</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">contexts</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>An array of objects, that allow you to provide
                                additional links or images in order to provide more
                                context to the trigger.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">proxy.host</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The proxy host to use (only in combination with <code class="literal">proxy.port</code>)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">proxy.port</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The proxy port to use (only in combination with <code class="literal">proxy.host</code>)</p></td></tr></tbody></table></div></div><br class="table-break" /><p>You can configure defaults for the above values for the whole service using the
<code class="literal">xpack.notification.pagerduty.event_defaults.*</code> properties as well as
per account using <code class="literal">xpack.notification.pagerduty.account.your_account_name.event_defaults.*</code></p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>All of those objects have templating support, so you can use data from the
      context and the payload as part of all the fields.</p></div></div><div class="table"><a id="pagerduty-event-trigger-context-attributes"></a><p class="title"><strong>Table 34. Pagerduty Event Trigger Context Attributes</strong></p><div class="table-contents"><table summary="Pagerduty Event Trigger Context Attributes" cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Name    </th><th align="center" valign="top">Required </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">type</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>One of <code class="literal">link</code> or <code class="literal">image</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">href</code></p></td><td align="center" valign="top"><p>yes/no</p></td><td align="left" valign="top"><p>A link to include more information. Must be there if the
                      type is <code class="literal">link</code>, optional if the type is <code class="literal">image</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">src</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>A src attribute for the <code class="literal">image</code> type.</p></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuring-pagerduty"></a>Configuring PagerDuty Accounts<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/pagerduty.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You configure the accounts Watcher uses to communicate with PagerDuty in
the <code class="literal">xpack.notification.pagerduty</code> namespace in <code class="literal">elasticsearch.yml</code>.</p><p>To configure a PagerDuty account, you need the API integration key for
the PagerDuty service you want to send notifications to. To get the
key:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Log in to <a class="ulink" href="http://pagerduty.com" target="_top">pagerduty.com</a> as an account administrator.
</li><li class="listitem"><p class="simpara">
Go to <span class="strong strong"><strong>Configuration &gt; Services</strong></span> and select the PagerDuty service. The
service must use the API integration.
</p><div class="informalfigure"><div class="mediaobject"><img src="images/pagerduty-services.jpg" alt="images/pagerduty-services.jpg" /></div></div></li><li class="listitem"><p class="simpara">
Click the <span class="strong strong"><strong>Integrations</strong></span> tab and copy the API integration key.
</p><div class="informalfigure"><div class="mediaobject"><img src="images/pagerduty-integrations.jpg" alt="images/pagerduty-integrations.jpg" /></div></div></li></ol></div><p>To configure a PagerDuty account in the keystore, you
must specify an account name and integration key, (see <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/secure-settings.html" target="_top">secure settings</a>):</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">bin/elasticsearch-keystore add xpack.notification.pagerduty.account.my_pagerduty_account.secure_service_api_key</pre></div><p>Storing the service api key in the YAML file or via cluster
update settings is still supported, but the keystore setting should be used</p><p>You can also specify defaults for the <a class="link" href="actions.html#pagerduty-event-trigger-incident-attributes" title="Table 33. Pagerduty Event Trigger Incident Attributes">PagerDuty event attributes</a>:
.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.pagerduty:
  account:
    my_pagerduty_account:
      event_defaults:
        description: "Watch notification"
        incident_key: "my_incident_key"
        client: "my_client"
        client_url: http://www.example.org
        event_type: trigger
        attach_payload: true</pre></div><p>If you configure multiple PagerDuty accounts, you either need to set a default
account or specify which account the event should be sent with in the
<a class="link" href="actions.html#actions-pagerduty" title="PagerDuty Action"><code class="literal">pagerduty</code></a> action.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.pagerduty:
  default_account: team1
  account:
    team1:
      ...
    team2:
      ...</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="actions-jira"></a>Jira Action<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/jira.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Use the <code class="literal">jira</code> action to create issues in  <a class="ulink" href="https://www.atlassian.com/software/jira" target="_top">Atlassian’s Jira Software</a>.
To create issues you need to <a class="link" href="actions.html#configuring-jira" title="Configuring Jira Accounts">configure at least one Jira account</a> in <code class="literal">elasticsearch.yml</code>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuring-jira-actions"></a>Configuring Jira Actions<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/jira.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You configure Jira actions in the <code class="literal">actions</code> array. Action-specific attributes
are specified using the <code class="literal">jira</code> keyword.</p><p>The following snippet shows a simple jira action definition:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"actions" : {
  "create-jira-issue" : {
    "transform" : { ... },
    "throttle_period" : "5m",
    "jira" : {
      "account" : "integration-account", <a id="CO46-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      "fields" : {
        "issue" : {
          "project" : {
            "key": "PROJ" <a id="CO46-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
          },
          "issuetype" : {
            "name": "Bug" <a id="CO46-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
          },
          "summary" : "Encountered {{ctx.payload.hits.total}} errors in the last 5 minutes", <a id="CO46-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
          "description" : "Encountered {{ctx.payload.hits.total}} errors in the last 5 minutes (facepalm)", <a id="CO46-5"></a><span><img src="images/icons/callouts/5.png" alt="" /></span>
          "labels" : ["auto"], <a id="CO46-6"></a><span><img src="images/icons/callouts/6.png" alt="" /></span>
          "priority" : {
            "name" : "High" <a id="CO46-7"></a><span><img src="images/icons/callouts/7.png" alt="" /></span>
          }
        }
      }
    }
  }
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO46-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The name of a Jira account configured in <code class="literal">elasticsearch.yml</code>.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO46-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The key of the Jira project in which the issue will be created.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO46-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The name of the issue type.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO46-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The summary of the Jira issue.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO46-5"><span><img src="images/icons/callouts/5.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The description of the Jira issue.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO46-6"><span><img src="images/icons/callouts/6.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The labels to apply to the Jira issue.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO46-7"><span><img src="images/icons/callouts/7.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The priority of the Jira issue.
</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="jira-action-attributes"></a>Jira Action Attributes<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/jira.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Depending of how Jira projects are configured, the issues can have many different fields and values. Therefore
the <code class="literal">jira</code> action can accept any type of sub fields within its <code class="literal">issue</code> field. These fields will be directly used
when calling Jira’s <a class="ulink" href="https://docs.atlassian.com/jira/REST/cloud/#api/2/issue-createIssue" target="_top">Create Issue API</a>, allowing
 any type of custom fields to be used.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The <code class="literal">project.key</code> (or <code class="literal">project.id</code>), the <code class="literal">issuetype.name</code> (or <code class="literal">issuetype.id</code>) and <code class="literal">issue.summary</code> are
always required to create an issue in Jira.</p></div></div><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /></colgroup><thead><tr><th align="left" valign="top"> Name                     </th><th align="center" valign="top">Required </th><th align="left" valign="top"> Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">account</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The Jira account to use to send the message.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">proxy.host</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The proxy host to use (only in combination with <code class="literal">proxy.port</code>)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">proxy.port</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The proxy port to use (only in combination with <code class="literal">proxy.host</code>)</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">fields.project.key</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>The key of the Jira project in which the issue will be created.
                                       It can be replaced by <code class="literal">issue.project.id</code> if the identifier of the
                                       project is known.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">fields.issuetype.name</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>A name that identifies the type of the issue. Jira provides default
                                       issue types like <code class="literal">Bug</code>, <code class="literal">Task</code>, <code class="literal">Story</code>, <code class="literal">New Feature</code> etc. It can
                                       be replaced by <code class="literal">issue.issuetype.id</code> if the identifier of the type
                                       is known.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">fields.summary</code></p></td><td align="center" valign="top"><p>yes</p></td><td align="left" valign="top"><p>The summary (or title) of the issue.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">fields.description</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The description of the issue.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">fields.labels</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The labels to apply to the Jira issue.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">fields.priority.name</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>The priority of the Jira issue. Jira provides default <code class="literal">High</code>,
                                       <code class="literal">Medium</code> and <code class="literal">Low</code> priority levels.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">fields.assignee.name</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Name of the user to assign the issue to.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">fields.reporter.name</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Name of the user identified as the reporter of the issue.
                                      Defaults to the user account.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">fields.environment</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Name of the environment related to the issue.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">fields.customfield_XXX</code></p></td><td align="center" valign="top"><p>no</p></td><td align="left" valign="top"><p>Custom field XXX of the issue (ex: "customfield_10000": "09/Jun/81")</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="configuring-jira"></a>Configuring Jira Accounts<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions/jira.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>You configure the accounts Watcher can use to communicate with Jira in the
<code class="literal">xpack.notification.jira</code> namespace in <code class="literal">elasticsearch.yml</code>.</p><p>Watcher supports Basic Authentication for Jira Software. To configure a
Jira account you need to specify (see <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/secure-settings.html" target="_top">secure settings</a>):</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">bin/elasticsearch-keystore xpack.notification.jira.account.monitoring.secure_url
bin/elasticsearch-keystore xpack.notification.jira.account.monitoring.secure_user
bin/elasticsearch-keystore xpack.notification.jira.account.monitoring.secure_password</pre></div><p>The insecure way of storing sensitive data (<code class="literal">url</code>, <code class="literal">user</code> and <code class="literal">password</code>)
in the configuration file or the cluster settings will be deprecated in the future.</p><p>To avoid credentials that transit in clear text over the network, Watcher will
reject <code class="literal">url</code> settings like <code class="literal">http://internal-jira.elastic.co</code> that are based on
plain text HTTP protocol. This default behavior can be disabled with the explicit
 <code class="literal">allow_http</code> setting:</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The <code class="literal">url</code> field can also contain a path, that is used to create an issue. By
default this is <code class="literal">/rest/api/2/issue</code>. If you set this as well, make sure that this
path is the full path to the endpoint to create an issue.</p></div></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.jira:
  account:
    monitoring:
      allow_http: true</pre></div><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>It is strongly advised to use Basic Authentication with secured HTTPS
 protocol only.</p></div></div><p>You can also specify defaults for the
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.3/notification-settings.html#jira-account-attributes" target="_top">Jira issues</a>:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.jira:
  account:
    monitoring:
      issue_defaults:
        project:
          key: proj
        issuetype:
          name: Bug
        summary: "X-Pack Issue"
        labels: ["auto"]</pre></div><p>If you configure multiple Jira accounts, you either need to configure a default
account or specify which account the notification should be sent with in the
<a class="link" href="actions.html#actions-jira" title="Jira Action">jira</a> action.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">xpack.notification.jira:
  default_account: team1
  account:
    team1:
      ...
    team2:
      ...</pre></div><h3><a id="actions-ssl-openjdk"></a>Using SSL/TLS with OpenJDK<a href="https://github.com/elastic/stack-docs/edit/6.3/../elasticsearch/x-pack/docs/en/watcher/actions.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>As each distributor is free to choose how to package OpenJDK, it may happen,
that even despite the exact same version, an OpenJDK distribution contains
different parts under different Linux distributions.</p><p>This can lead to issues with any action or input that uses TLS, like the <code class="literal">jira</code>,
<code class="literal">pagerduty</code>, <code class="literal">slack</code>, <code class="literal">hipchat</code> or <code class="literal">webhook</code> one, because of missing CA certs.
If you encounter TLS errors, when writing watches that connect to TLS endpoints,
you should try to upgrade to the latest available OpenJDK distribution for your
platform and if that does not help, try to upgrade to Oracle JDK.</p></div></div></div><div class="navfooter"><span class="prev"><a href="condition.html">
              « 
              Conditions</a>
           
        </span><span class="next">
           
          <a href="transform.html">Transforms
               »
            </a></span></div>
<!-- end body -->

            </div>
            <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
        
					<div id="rtpcontainer" style="display: block;">
						<div class="mktg-promo">
						<h3>Getting Started Videos</h3>
						<ul class="icons">
							<li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
							<li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
							<li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
						</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

        </div>
      	


<div id="footer-subscribe" class="home-footer-subscribe">
  <div class="subscribe-wrapper">
    <div class="container">
      <div class="subscribe-form-container">
        <div class="subscribe-title col-md-12 col-lg-6">
            <h5>Be in the know with the latest and greatest from Elastic.</h5>
        </div>
        <div class="subscribe-form col-md-12 col-lg-6">
          <form id="mktoForm_1398" class="mktoForm sb-form"></form>
        </div>
      </div>
      <div class="form_thanks hide">
        
          <p>Thanks for subscribing! We'll keep you updated with new releases.</p>
        
      </div>
    </div>
  </div>
</div>
<!--subscribe newsletter end-->

<!-- Footer Section -->
<footer class="footer-wrapper">
  <div class="container">
    <div class="row footer-content">
        
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/products">Products ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/products/elasticsearch">Elasticsearch</a></li>
                  
                
              
                
                  
                    <li><a href="/products/kibana">Kibana</a></li>
                  
                
              
                
                  
                    <li><a href="/products/beats">Beats</a></li>
                  
                
              
                
                  
                    <li><a href="/products/logstash">Logstash</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack">X-Pack</a></li>
                  
                
              
                
                  
                    <li><a href="/cloud/as-a-service">Elastic Cloud</a></li>
                  
                
              
                
                  
                    <li><a href="/cloud/enterprise">Elastic Cloud Enterprise</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/security">Security (formerly Shield)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/alerting">Alerting (via Watcher)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/monitoring">Monitoring (formerly Marvel)</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/graph">Graph</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/reporting">Reporting</a></li>
                  
                
              
                
                  
                    <li><a href="/products/x-pack/machine-learning">Machine Learning</a></li>
                  
                
              
                
                  
                    <li><a href="/products/hadoop">ES-Hadoop</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/solutions">Solutions ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/solutions/logging">Logging</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/metrics">Metrics</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/site-search">Site Search</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/security-analytics">Security Analytics</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/apm">APM</a></li>
                  
                
              
                
                  
                    <li><a href="/solutions/app-search">App Search</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3>Resources</h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/blog">Blog</a></li>
                  
                
              
                
                  
                    <li><a href="https://cloud-status.elastic.co">Cloud Status</a></li>
                  
                
              
                
                  
                    <li><a href="/community">Community</a></li>
                  
                
              
                
                  
                    <li><a href="/use-cases">Customers & Use Cases</a></li>
                  
                
              
                
                  
                    <li><a href="/guide">Documentation</a></li>
                  
                
              
                
                  
                    <li><a href="/elasticon">Elastic{ON} Events</a></li>
                  
                
              
                
                  
                    <li><a href="https://discuss.elastic.co/">Forums</a></li>
                  
                
              
                
                  
                    <li><a href="/community/meetups">Meetups</a></li>
                  
                
              
                
                  
                    <li><a href="/subscriptions">Subscriptions</a></li>
                  
                
              
                
                  
                    <li><a href="https://support.elastic.co">Support Portal</a></li>
                  
                
              
                
                  
                    <li><a href="/videos">Videos & Webinars</a></li>
                  
                
              
                
                  
                    <li><a href="/training">Training</a></li>
                  
                
              
              </ul>
          </div>    
      
          <div class="col-xs-6 col-sm-3 col-md-3">
              
                <h3><a href="/about">About ></a></h3>
              
              
              
              <ul class="">
              
                
                  
                    <li><a href="/about/careers">Careers/Jobs</a></li>
                  
                
              
                
                  
                    <li><a href="/contact">Contact</a></li>
                  
                
              
                
                  
                    <li><a href="/about/leadership">Leadership</a></li>
                  
                
              
                
                  
                    <li><a href="/about/partners">Partners</a></li>
                  
                
              
                
                  
                    <li><a href="/about/press">Press</a></li>
                  
                
              
                
                  
                    <li><a href="https://www.elastic.shop">Elastic Store</a></li>
                  
                
              
              </ul>
          </div>    
       
    </div>
     <!-- Social Media Section -->
    <div class="row social-icon">
      <div class="col-xs-12 col-sm-12 col-md-6 col-md-offset-3">
	    <div class="row">
		     <div class="follow-us col-xs-12 col-sm-12 col-md-12">
			    <div class="social-label">FOLLOW US</div>
			    <ul class="social-icon-list">
          
          		 	<li class="facebook"><a id="footer_facebook" href="http://www.facebook.com/elastic.co"></a></li>
          
          		 	<li class="twitter"><a id="footer_twitter" href="https://www.twitter.com/elastic"></a></li>
          
          		 	<li class="linkedin"><a id="footer_linkedin" href="https://www.linkedin.com/company/elastic-co"></a></li>
          
          		 	<li class="xing"><a id="footer_xing" href="https://www.xing.com/companies/elastic.co"></a></li>
          
          		 	<li class="youtube"><a id="footer_youtube" href="https://www.youtube.com/user/elasticsearch"></a></li>
          
		  		</ul>
		     </div>
	    </div>
      </div>
    </div>
    <!-- Social Media Section end-->
    <div class="row">
	<div class="col-xs-12 col-sm-12 col-md-11">
		<div class="copyright">
			<ul>
				<li><a href="/legal/trademarks">Trademarks</a></li>
				<li><a href="/legal/terms-of-use">Terms of Use</a></li>
				<li><a href="/legal/privacy-policy">Privacy</a></li>
				<li><a href="/legal/privacy-and-cookie-policy">Cookie Policy</a></li>
				<li><a href="/brand">Brand</a></li>
			</ul>
			<div class="copyright-content">				
				<div class="footer-text">
					<p>© 2018. All Rights Reserved - Elasticsearch
					</p>
					<p>Elasticsearch is a trademark of Elasticsearch BV, registered in the U.S. and in other countries.
					</p>
					<p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a> in the United States and/or other countries.
					</p>
				</div>
			</div>			
		</div>
	</div>
	<div class="col-xs-2 col-xs-offset-5 col-sm-1 col-sm-offset-5 col-md-1 col-md-offset-0">
		<div class="footer-logo"><a href="/"><img src="/static/images/svg/logo-elastic-footer-stacked-999.svg" class="img-responsive"></a></div>
	</div>
</div>
  </div>
</footer>
<!-- Footer Section end-->

<style type="text/css">
	
        
            .facebook a {background:url("/assets/bltf546ff2e0a8f2de5/facebook.svg") no-repeat;}
            .facebook a:before {
                content: url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .facebook a:hover {background:url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg")}		
        
	
        
            .twitter a {background:url("/assets/bltdd9556d6b24e2b85/twitter.svg") no-repeat;}
            .twitter a:before {
                content: url("/assets/blt90b0372cc07a54d3/twitter-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .twitter a:hover {background:url("/assets/blt90b0372cc07a54d3/twitter-hover.svg")}		
        
	
        
            .linkedin a {background:url("/assets/bltc4a77e0f52ce07f1/linkedin.svg") no-repeat;}
            .linkedin a:before {
                content: url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .linkedin a:hover {background:url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg")}		
        
	
        
            .xing a {background:url("/assets/bltc6347078dcc9ec76/xing.svg") no-repeat;}
            .xing a:before {
                content: url("/assets/bltededebe5f7521a39/xing-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .xing a:hover {background:url("/assets/bltededebe5f7521a39/xing-hover.svg")}		
        
	
        
            .youtube a {background:url("/assets/blt4982061ce1aebc7f/youtube.svg") no-repeat;}
            .youtube a:before {
                content: url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .youtube a:hover {background:url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg")}		
        
	
</style>

<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
<script>
  MktoForms2.whenReady(function (form) {
  //    // Put your code that uses the form object here
  //   $('#Email').attr("placeholder","Email Address");
  //   $('#FirstName').attr("placeholder","First Name");
  //   $('#LastName').attr("placeholder","Last Name");
  //   $('#Form_Message').attr("placeholder","Tell us in your words");
  // // ========================End Mktoform placeholder==================
  });
  MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", 1398,function(form){
    console.log("inside footer form", form);
    form.onSuccess(function(form){
      $('#mktoForm_1398').css('display','none');
      $('.subscribe-wrapper .subscribe-form-container').hide();
      $('.subscribe-wrapper').find('.form_thanks').removeClass('hide')
      dataLayer.push({'event': 'mktoFormSubmit'});
        return false;
      });
  });
</script>
      </section>
    </div>

    
     <script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";	
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script src="/static/js/nav-v5.js"></script>
<script src="/static/js/script.js"></script> 
     
<script type="text/javascript">
$(document).ready(function(){
	if (window.location.hash.length) {
	      var target = $(window.location.hash);
	      target = target.length ? target : $(window.location.hash);
	      if (target.length) {
	        setTimeout(function(){ $(window).scrollTop(target.offset().top - 60); }, 1200);        
	      }
	}
	$('#guide').on('click','a[href*=#]:not([href=#])',function(e) {
			var flag=true;
		      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
		          var target = $(this.hash);
		          target = target.length ? target :$(this.hash);
		          if (target.length) {
		            if(flag){
		              flag=false;
		              var heightScroll=($('.tertiary-nav.navbar-fixed-top').height())?60:110;
		              $('html,body').animate({
		                  scrollTop: target.offset().top - heightScroll
		                }, 2000, function(){
		                  flag=true;
		                });
		            }                    
		          }
		      }
		    
	});

})

</script>

     <style></style>
     
  
            <script type="text/javascript" src="docs.js"></script>
<script type='text/javascript' src='https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=yaml'></script>

            </body>
        
</html>